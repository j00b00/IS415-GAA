<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-03-23">

<title>IS415-GAA - Take Home Excerise 03</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hand-on-excerise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hand-on Excerise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hand-on-excerise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hand-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hand-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" rel="" target="">
 <span class="dropdown-text">Hand-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">Hand-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html" rel="" target="">
 <span class="dropdown-text">Hand-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">Hand-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html" rel="" target="">
 <span class="dropdown-text">Hand-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">Hand-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html" rel="" target="">
 <span class="dropdown-text">Hand-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html" rel="" target="">
 <span class="dropdown-text">Hand-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-Class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_ex03/In-class_Ex03-NKDE.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3 - NKDE</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#install-and-uploading-r-packages" id="toc-install-and-uploading-r-packages" class="nav-link active" data-scroll-target="#install-and-uploading-r-packages">1.0 Install and uploading R packages</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">2.0 Data</a>
  <ul class="collapse">
  <li><a href="#importing-geospatial-data" id="toc-importing-geospatial-data" class="nav-link" data-scroll-target="#importing-geospatial-data">2.1 Importing geospatial data</a>
  <ul class="collapse">
  <li><a href="#plotting-the-geospatial-data" id="toc-plotting-the-geospatial-data" class="nav-link" data-scroll-target="#plotting-the-geospatial-data">2.1.1 Plotting the geospatial data</a></li>
  </ul></li>
  <li><a href="#importing-aspatial-data" id="toc-importing-aspatial-data" class="nav-link" data-scroll-target="#importing-aspatial-data">2.2 Importing aspatial data</a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">3.0 Data Wrangling</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">4.0 Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#plotting-of-histogram" id="toc-plotting-of-histogram" class="nav-link" data-scroll-target="#plotting-of-histogram">4.1 Plotting of Histogram</a>
  <ul class="collapse">
  <li><a href="#using-the-column-security_ind" id="toc-using-the-column-security_ind" class="nav-link" data-scroll-target="#using-the-column-security_ind">4.1.1 Using the column (security_ind)</a></li>
  <li><a href="#using-the-column-theft_ind" id="toc-using-the-column-theft_ind" class="nav-link" data-scroll-target="#using-the-column-theft_ind">4.1.2 Using the column (theft_ind)</a></li>
  <li><a href="#using-the-column-police_ind" id="toc-using-the-column-police_ind" class="nav-link" data-scroll-target="#using-the-column-police_ind">4.1.3 Using the column (police_ind)</a></li>
  <li><a href="#using-the-column-gangster_ind" id="toc-using-the-column-gangster_ind" class="nav-link" data-scroll-target="#using-the-column-gangster_ind">4.1.4 Using the column (gangster_ind)</a></li>
  </ul></li>
  <li><a href="#plotting-of-boxplot" id="toc-plotting-of-boxplot" class="nav-link" data-scroll-target="#plotting-of-boxplot">4.2 Plotting of Boxplot</a>
  <ul class="collapse">
  <li><a href="#using-the-column-security_ind-1" id="toc-using-the-column-security_ind-1" class="nav-link" data-scroll-target="#using-the-column-security_ind-1">4.2.1 Using the column (security_ind)</a></li>
  <li><a href="#using-the-column-theft_ind-1" id="toc-using-the-column-theft_ind-1" class="nav-link" data-scroll-target="#using-the-column-theft_ind-1">4.2.2 Using the column (theft_ind)</a></li>
  <li><a href="#using-the-column-police_ind-1" id="toc-using-the-column-police_ind-1" class="nav-link" data-scroll-target="#using-the-column-police_ind-1">4.2.3 Using the column (police_ind)</a></li>
  <li><a href="#using-the-column-gangster_ind-1" id="toc-using-the-column-gangster_ind-1" class="nav-link" data-scroll-target="#using-the-column-gangster_ind-1">4.2.4 Using the column (gangster_ind)</a></li>
  </ul></li>
  <li><a href="#eda-using-choropleth-map" id="toc-eda-using-choropleth-map" class="nav-link" data-scroll-target="#eda-using-choropleth-map">4.3 EDA using choropleth map</a>
  <ul class="collapse">
  <li><a href="#joining-the-two-datasets" id="toc-joining-the-two-datasets" class="nav-link" data-scroll-target="#joining-the-two-datasets">4.3.1 Joining the two datasets</a></li>
  <li><a href="#preparing-a-choropleth-map" id="toc-preparing-a-choropleth-map" class="nav-link" data-scroll-target="#preparing-a-choropleth-map">4.3.2 Preparing a choropleth map</a></li>
  <li><a href="#correlation-analysis" id="toc-correlation-analysis" class="nav-link" data-scroll-target="#correlation-analysis">4.4 Correlation analysis</a></li>
  <li><a href="#hierarchy-cluster-analysis" id="toc-hierarchy-cluster-analysis" class="nav-link" data-scroll-target="#hierarchy-cluster-analysis">4.5 Hierarchy Cluster Analysis</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Excerise 03</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 23, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="install-and-uploading-r-packages" class="level1">
<h1>1.0 Install and uploading R packages</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sp, spdep, tmap, sf, ClustGeo, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               ggpubr, cluster, factoextra, NbClust,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               heatmaply, corrplot, psych, tidyverse, GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data" class="level1">
<h1>2.0 Data</h1>
<section id="importing-geospatial-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-geospatial-data">2.1 Importing geospatial data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>vietnam <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>, <span class="at">layer =</span> <span class="st">"vnm_admbnda_adm1_gov_20201027"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `vnm_admbnda_adm1_gov_20201027' from data source 
  `C:\j00b00\IS415-GAA\Take-home_EX\Take-home_Ex03\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 63 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 102.144 ymin: 7.180931 xmax: 117.8355 ymax: 23.39221
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<section id="plotting-the-geospatial-data" class="level3">
<h3 class="anchored" data-anchor-id="plotting-the-geospatial-data">2.1.1 Plotting the geospatial data</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(vietnam))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">max.categories =</span> <span class="dv">63</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(vietnam) <span class="sc">+</span> <span class="fu">tm_polygons</span>(<span class="st">"ADM1_EN"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="importing-aspatial-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-aspatial-data">2.2 Importing aspatial data</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pci_2021 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/pci_2021.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pci_2021</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 63 × 7
   Region                 Province Sub-Index 10: Law &amp; …¹ Good security situat…²
   &lt;chr&gt;                  &lt;chr&gt;                     &lt;dbl&gt; &lt;chr&gt;                 
 1 Mekong River           An Giang                   6.86 72%                   
 2 Southeast              BRVT                       7.41 77%                   
 3 Northern midlands and… Bac Gia…                   8.6  87%                   
 4 Northern midlands and… Bac Kan                    8.02 87%                   
 5 Mekong River           Bac Lieu                   8.02 91%                   
 6 Red River Delta        Bac Ninh                   7.09 85%                   
 7 Mekong River           Ben Tre                    7.83 81%                   
 8 Central Coast          Binh Di…                   8.04 73%                   
 9 Southeast              Binh Du…                   6.84 61%                   
10 Southeast              Binh Ph…                   7.49 60%                   
# ℹ 53 more rows
# ℹ abbreviated names: ¹​`Sub-Index 10: Law &amp; Order`,
#   ²​`Good security situation in the province (%)`
# ℹ 3 more variables: `Victim of theft or break-in last year (%)` &lt;chr&gt;,
#   `Local police handle firm's case effectively (%)` &lt;chr&gt;,
#   `Pay money to gangsters groups (%)` &lt;chr&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="data-wrangling" class="level1">
<h1>3.0 Data Wrangling</h1>
<p>Rename the columns</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pci_2021 <span class="ot">&lt;-</span> pci_2021 <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">overall_index</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Sub-Index 10: Law &amp; Order</span><span class="st">`</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">security_ind</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Good security situation in the province (%)</span><span class="st">`</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">theft_ind</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Victim of theft or break-in last year (%)</span><span class="st">`</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">police_ind</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Local police handle firm's case effectively (%)</span><span class="st">`</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">gangster_ind</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Pay money to gangsters groups (%)</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Finding the unique Province in pci_2021 (aspatial data)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(pci_2021<span class="sc">$</span>Province)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "An Giang"    "BRVT"        "Bac Giang"   "Bac Kan"     "Bac Lieu"   
 [6] "Bac Ninh"    "Ben Tre"     "Binh Dinh"   "Binh Duong"  "Binh Phuoc" 
[11] "Binh Thuan"  "Ca Mau"      "Can Tho"     "Cao Bang"    "Da Nang"    
[16] "Dak Lak"     "Dak Nong"    "Dien Bien"   "Dong Nai"    "Dong Thap"  
[21] "Gia Lai"     "HCMC"        "Ha Giang"    "Ha Nam"      "Ha Noi"     
[26] "Ha Tinh"     "Hai Duong"   "Hai Phong"   "Hau Giang"   "Hoa Binh"   
[31] "Hung Yen"    "Khanh Hoa"   "Kien Giang"  "Kon Tum"     "Lai Chau"   
[36] "Lam Dong"    "Lang Son"    "Lao Cai"     "Long An"     "Nam Dinh"   
[41] "Nghe An"     "Ninh Binh"   "Ninh Thuan"  "Phu Tho"     "Phu Yen"    
[46] "Quang Binh"  "Quang Nam"   "Quang Ngai"  "Quang Ninh"  "Quang Tri"  
[51] "Soc Trang"   "Son La"      "TT-Hue"      "Tay Ninh"    "Thai Binh"  
[56] "Thai Nguyen" "Thanh Hoa"   "Tien Giang"  "Tra Vinh"    "Tuyen Quang"
[61] "Vinh Long"   "Vinh Phuc"   "Yen Bai"    </code></pre>
</div>
</div>
<p>Finding the unique Province in Vietnam (geospatial data)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(vietnam<span class="sc">$</span>ADM1_EN)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "An Giang"          "Ba Ria - Vung Tau" "Bac Giang"        
 [4] "Bac Kan"           "Bac Lieu"          "Bac Ninh"         
 [7] "Ben Tre"           "Binh Dinh"         "Binh Duong"       
[10] "Binh Phuoc"        "Binh Thuan"        "Ca Mau"           
[13] "Can Tho city"      "Cao Bang"          "Da Nang city"     
[16] "Dak Lak"           "Dak Nong"          "Dien Bien"        
[19] "Dong Nai"          "Dong Thap"         "Gia Lai"          
[22] "Ha Giang"          "Ha Nam"            "Ha Noi"           
[25] "Ha Tinh"           "Hai Duong"         "Hai Phong city"   
[28] "Hau Giang"         "Ho Chi Minh city"  "Hoa Binh"         
[31] "Hung Yen"          "Khanh Hoa"         "Kien Giang"       
[34] "Kon Tum"           "Lai Chau"          "Lam Dong"         
[37] "Lang Son"          "Lao Cai"           "Long An"          
[40] "Nam Dinh"          "Nghe An"           "Ninh Binh"        
[43] "Ninh Thuan"        "Phu Tho"           "Phu Yen"          
[46] "Quang Binh"        "Quang Nam"         "Quang Ngai"       
[49] "Quang Ninh"        "Quang Tri"         "Soc Trang"        
[52] "Son La"            "Tay Ninh"          "Thai Binh"        
[55] "Thai Nguyen"       "Thanh Hoa"         "Thua Thien Hue"   
[58] "Tien Giang"        "Tra Vinh"          "Tuyen Quang"      
[61] "Vinh Long"         "Vinh Phuc"         "Yen Bai"          </code></pre>
</div>
</div>
<p>Finding the province that appear in pci_2021 but not in Vietnam</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pci_2021 <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Province <span class="sc">%in%</span> vietnam<span class="sc">$</span>ADM1_EN) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Province)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 1
  Province 
  &lt;chr&gt;    
1 BRVT     
2 Can Tho  
3 Da Nang  
4 HCMC     
5 Hai Phong
6 TT-Hue   </code></pre>
</div>
</div>
<p>Rename the Province’s name in pci_2021 with the name in Vietnam</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pci_2021 <span class="ot">&lt;-</span> pci_2021 <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Province =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    Province <span class="sc">==</span> <span class="st">"BRVT"</span> <span class="sc">~</span> <span class="st">"Ba Ria - Vung Tau"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    Province <span class="sc">==</span> <span class="st">"Can Tho"</span> <span class="sc">~</span> <span class="st">"Can Tho city"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    Province <span class="sc">==</span> <span class="st">"Da Nang"</span> <span class="sc">~</span> <span class="st">"Da Nang city"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    Province <span class="sc">==</span> <span class="st">"HCMC"</span> <span class="sc">~</span> <span class="st">"Ho Chi Minh city"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    Province <span class="sc">==</span> <span class="st">"Hai Phong"</span> <span class="sc">~</span> <span class="st">"Hai Phong city"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    Province <span class="sc">==</span> <span class="st">"TT-Hue"</span> <span class="sc">~</span> <span class="st">"Thua Thien Hue"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> Province</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pci_2021 <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Province <span class="sc">%in%</span> vietnam<span class="sc">$</span>ADM1_EN) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Province)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 1
# ℹ 1 variable: Province &lt;chr&gt;</code></pre>
</div>
</div>
<p>Removing the percentage sign so that the data become numerical</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pci_2021 <span class="ot">&lt;-</span> pci_2021 <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">ends_with</span>(<span class="st">"ind"</span>), <span class="sc">~</span><span class="fu">as.integer</span>(<span class="fu">str_remove</span>(., <span class="st">"%"</span>))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pci_2021)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Region            Province         overall_index    security_ind  
 Length:63          Length:63          Min.   :6.500   Min.   :59.00  
 Class :character   Class :character   1st Qu.:7.150   1st Qu.:72.50  
 Mode  :character   Mode  :character   Median :7.510   Median :78.00  
                                       Mean   :7.537   Mean   :77.35  
                                       3rd Qu.:7.900   3rd Qu.:81.00  
                                       Max.   :8.600   Max.   :92.00  
   theft_ind        police_ind      gangster_ind   
 Min.   : 1.000   Min.   : 66.00   Min.   :0.0000  
 1st Qu.: 4.000   1st Qu.: 81.00   1st Qu.:0.0000  
 Median : 6.000   Median : 87.00   Median :1.0000  
 Mean   : 6.873   Mean   : 86.44   Mean   :0.9683  
 3rd Qu.:10.000   3rd Qu.: 93.50   3rd Qu.:1.5000  
 Max.   :16.000   Max.   :100.00   Max.   :4.0000  </code></pre>
</div>
</div>
<p>Saving to rds</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(pci_2021, <span class="st">"data/rds/pci_2021.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>4.0 Exploratory Data Analysis</h1>
<section id="plotting-of-histogram" class="level2">
<h2 class="anchored" data-anchor-id="plotting-of-histogram">4.1 Plotting of Histogram</h2>
<section id="using-the-column-security_ind" class="level3">
<h3 class="anchored" data-anchor-id="using-the-column-security_ind">4.1.1 Using the column (security_ind)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pci_2021,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">security_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="using-the-column-theft_ind" class="level3">
<h3 class="anchored" data-anchor-id="using-the-column-theft_ind">4.1.2 Using the column (theft_ind)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pci_2021, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">theft_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="using-the-column-police_ind" class="level3">
<h3 class="anchored" data-anchor-id="using-the-column-police_ind">4.1.3 Using the column (police_ind)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pci_2021, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">police_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="using-the-column-gangster_ind" class="level3">
<h3 class="anchored" data-anchor-id="using-the-column-gangster_ind">4.1.4 Using the column (gangster_ind)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pci_2021, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">gangster_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="plotting-of-boxplot" class="level2">
<h2 class="anchored" data-anchor-id="plotting-of-boxplot">4.2 Plotting of Boxplot</h2>
<section id="using-the-column-security_ind-1" class="level3">
<h3 class="anchored" data-anchor-id="using-the-column-security_ind-1">4.2.1 Using the column (security_ind)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pci_2021, </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">security_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="using-the-column-theft_ind-1" class="level3">
<h3 class="anchored" data-anchor-id="using-the-column-theft_ind-1">4.2.2 Using the column (theft_ind)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pci_2021, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">theft_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="using-the-column-police_ind-1" class="level3">
<h3 class="anchored" data-anchor-id="using-the-column-police_ind-1">4.2.3 Using the column (police_ind)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pci_2021, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">police_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="using-the-column-gangster_ind-1" class="level3">
<h3 class="anchored" data-anchor-id="using-the-column-gangster_ind-1">4.2.4 Using the column (gangster_ind)</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>pci_2021, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">gangster_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill=</span><span class="st">"light blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="eda-using-choropleth-map" class="level2">
<h2 class="anchored" data-anchor-id="eda-using-choropleth-map">4.3 EDA using choropleth map</h2>
<section id="joining-the-two-datasets" class="level3">
<h3 class="anchored" data-anchor-id="joining-the-two-datasets">4.3.1 Joining the two datasets</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(vietnam, pci_2021, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"ADM1_EN"</span><span class="ot">=</span><span class="st">"Province"</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(combined_data, <span class="st">"data/rds/combined_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="preparing-a-choropleth-map" class="level3">
<h3 class="anchored" data-anchor-id="preparing-a-choropleth-map">4.3.2 Preparing a choropleth map</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(combined_data, <span class="st">"security_ind"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="correlation-analysis" class="level3">
<h3 class="anchored" data-anchor-id="correlation-analysis">4.4 Correlation analysis</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>cluster_vars.cor <span class="ot">=</span> <span class="fu">cor</span>(pci_2021[,<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(cluster_vars.cor,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="st">"ellipse"</span>, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">upper =</span> <span class="st">"number"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.pos =</span> <span class="st">"lt"</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">diag =</span> <span class="st">"l"</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">tl.col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="hierarchy-cluster-analysis" class="level3">
<h3 class="anchored" data-anchor-id="hierarchy-cluster-analysis">4.5 Hierarchy Cluster Analysis</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cluster_vars <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"ADM1_EN"</span>,<span class="st">"security_ind"</span>, <span class="st">"theft_ind"</span>, <span class="st">"police_ind"</span>, <span class="st">"gangster_ind"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             ADM1_EN security_ind theft_ind police_ind gangster_ind
1           An Giang           72        16         83            2
2  Ba Ria - Vung Tau           77         9         84            1
3          Bac Giang           87         3         87            1
4            Bac Kan           87         2         97            1
5           Bac Lieu           91         9         94            0
6           Bac Ninh           85         6         96            3
7            Ben Tre           81         8         92            1
8          Binh Dinh           73         4         81            1
9         Binh Duong           61         9         73            0
10        Binh Phuoc           60         7         76            0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(cluster_vars) <span class="ot">&lt;-</span> cluster_vars<span class="sc">$</span><span class="st">"ADM1_EN"</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cluster_vars,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            ADM1_EN security_ind theft_ind police_ind
An Giang                   An Giang           72        16         83
Ba Ria - Vung Tau Ba Ria - Vung Tau           77         9         84
Bac Giang                 Bac Giang           87         3         87
Bac Kan                     Bac Kan           87         2         97
Bac Lieu                   Bac Lieu           91         9         94
Bac Ninh                   Bac Ninh           85         6         96
Ben Tre                     Ben Tre           81         8         92
Binh Dinh                 Binh Dinh           73         4         81
Binh Duong               Binh Duong           61         9         73
Binh Phuoc               Binh Phuoc           60         7         76
                  gangster_ind
An Giang                     2
Ba Ria - Vung Tau            1
Bac Giang                    1
Bac Kan                      1
Bac Lieu                     0
Bac Ninh                     3
Ben Tre                      1
Binh Dinh                    1
Binh Duong                   0
Binh Phuoc                   0</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">select</span>(cluster_vars, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(combined_data, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  security_ind theft_ind police_ind gangster_ind
An Giang                    72        16         83            2
Ba Ria - Vung Tau           77         9         84            1
Bac Giang                   87         3         87            1
Bac Kan                     87         2         97            1
Bac Lieu                    91         9         94            0
Bac Ninh                    85         6         96            3
Ben Tre                     81         8         92            1
Binh Dinh                   73         4         81            1
Binh Duong                  61         9         73            0
Binh Phuoc                  60         7         76            0</code></pre>
</div>
</div>
<p>Data Standardization</p>
<p>Min-Max standardisation</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>combined_data.std <span class="ot">&lt;-</span> <span class="fu">normalize</span>(combined_data)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(combined_data.std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  security_ind      theft_ind        police_ind      gangster_ind   
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.4091   1st Qu.:0.2000   1st Qu.:0.4412   1st Qu.:0.0000  
 Median :0.5758   Median :0.3333   Median :0.6176   Median :0.2500  
 Mean   :0.5560   Mean   :0.3915   Mean   :0.6013   Mean   :0.2421  
 3rd Qu.:0.6667   3rd Qu.:0.6000   3rd Qu.:0.8088   3rd Qu.:0.3750  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>combined_data.z <span class="ot">&lt;-</span> <span class="fu">normalize</span>(combined_data)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(combined_data.z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  security_ind      theft_ind        police_ind      gangster_ind   
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.4091   1st Qu.:0.2000   1st Qu.:0.4412   1st Qu.:0.0000  
 Median :0.5758   Median :0.3333   Median :0.6176   Median :0.2500  
 Mean   :0.5560   Mean   :0.3915   Mean   :0.6013   Mean   :0.2421  
 3rd Qu.:0.6667   3rd Qu.:0.6000   3rd Qu.:0.8088   3rd Qu.:0.3750  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  </code></pre>
</div>
</div>
<p>visualizing standardized clustering variables</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pci_2021, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">security_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values without standardisation"</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>combined_data_std_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(combined_data.std)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>combined_data_std_df, </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">security_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max Standardisation"</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>combined_data_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(combined_data.z)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>combined_data_z_df, </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">security_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score Standardisation"</span>)</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>pci_2021, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span> <span class="st">`</span><span class="at">security_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Raw values without standardisation"</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>combined_data_std_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(combined_data.std)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>combined_data_std_df, </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">security_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Min-Max Standardisation"</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>combined_data_z_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(combined_data.z)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>combined_data_z_df, </span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span><span class="st">`</span><span class="at">security_ind</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">bins=</span><span class="dv">20</span>, </span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">"black"</span>, </span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">"light blue"</span>) <span class="sc">+</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Z-score Standardisation"</span>)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(r, s, z,</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>computing proximity matrix</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>proxmat <span class="ot">&lt;-</span> <span class="fu">dist</span>(combined_data, <span class="at">method =</span> <span class="st">'euclidean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>proxmat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   An Giang Ba Ria - Vung Tau Bac Giang   Bac Kan  Bac Lieu
Ba Ria - Vung Tau  8.717798                                                
Bac Giang         20.273135         12.041595                              
Bac Kan           24.859606         17.832555 10.049876                    
Bac Lieu          23.130067         17.233688 10.099505  8.660254          
Bac Ninh          20.952327         14.866069  9.899495  5.000000  7.615773
Ben Tre           15.066519          9.000000  9.273618  9.848858 10.295630
Binh Dinh         12.247449          7.071068 15.264338 21.354157 22.781571
Binh Duong        16.552945         19.442222 30.149627 36.083237 36.619667
Binh Phuoc        16.673332         18.920888 29.444864 34.583233 35.902646
Binh Thuan        13.152946         14.106736 23.366643 31.352831 29.899833
Ca Mau            14.212670          8.366600 12.369317 21.494185 19.824228
Can Tho city      16.431677          8.831761  4.582576 11.401754  9.433981
Cao Bang          15.427249          8.366600  9.219544 10.488088 13.000000
Da Nang city      16.583124         11.874342 14.560220 12.529964 16.552945
Dak Lak           11.575837          6.164414 11.269428 13.416408 13.747727
Dak Nong          14.106736         10.049876 13.638182 12.609520 14.000000
Dien Bien         11.357817          4.795832 12.409674 16.155494 17.720045
Dong Nai          12.409674         15.297059 25.826343 32.954514 31.984371
Dong Thap         10.392305          4.472136 10.440307 16.911535 14.317821
Gia Lai           21.863211         23.537205 32.939338 39.899875 40.484565
Ha Giang          16.522712          8.660254  5.477226 14.730920 12.884099
Ha Nam            13.784049          6.164414  9.643651 17.832555 17.748239
Ha Noi            15.874508          7.211103  6.708204 14.352700 15.394804
Ha Tinh           15.937377          7.348469  7.280110 15.297059 16.031220
Hai Duong         16.278821          7.681146  7.348469 13.892444 15.874508
Hai Phong city    20.049938         16.792856 20.273135 17.088007 22.203603
Hau Giang         12.727922         10.488088 15.198684 14.491377 14.456832
Ho Chi Minh city   8.306624          6.244998 17.029386 22.825424 23.237900
Hoa Binh           9.433981         10.344080 20.346990 22.113344 23.579652
Hung Yen          19.874607         13.152946 10.000000  6.403124 11.747340
Khanh Hoa          6.708204          7.141428 18.493242 22.293497 22.891046
Kien Giang         8.185353         10.440307 21.400935 28.231188 27.092434
Kon Tum           12.124356         10.049876 18.867962 26.551836 26.267851
Lai Chau          12.247449          6.782330 10.344080 12.727922 11.789826
Lam Dong          21.517435         13.000000  2.449490 11.090537 12.000000
Lang Son          15.394804          8.660254 10.862780 11.874342 15.165751
Lao Cai           10.862780          3.741657 11.180340 18.867962 17.748239
Long An           17.291616         22.022716 33.316662 39.127995 39.089641
Nam Dinh          23.558438         16.401219  7.348469  4.123106  5.477226
Nghe An           17.492856         18.493242 28.266588 34.117444 35.454196
Ninh Binh         21.447611         18.547237 22.561028 32.155870 30.740852
Ninh Thuan        18.165902         10.677078  4.582576  9.273618  9.643651
Phu Tho           14.491377          6.480741  6.855655 11.575837 12.041595
Phu Yen           16.431677         14.212670 17.748239 14.491377 16.643317
Quang Binh         3.000000          7.937254 19.646883 25.079872 23.748684
Quang Nam          7.071068          4.690416 15.329710 22.181073 20.712315
Quang Ngai        18.165902         14.628739 17.291616 13.638182 17.748239
Quang Ninh        21.633308         13.564660  2.236068 11.224972 10.246951
Quang Tri         10.723805         10.440307 20.445048 23.388031 25.455844
Soc Trang          9.219544          2.645751 11.489125 16.340135 15.297059
Son La            16.852300         10.392305 10.908712 10.099505 13.964240
Tay Ninh          13.928388          9.486833 14.035669 13.638182 16.155494
Thai Binh         23.853721         16.822604 10.677078  3.316625 11.045361
Thai Nguyen       21.840330         14.798649  6.480741  5.196152  5.477226
Thanh Hoa         26.870058         20.639767 13.228757  4.242641  8.306624
Thua Thien Hue    28.248894         21.400935 12.124356  5.291503  7.280110
Tien Giang         9.848858          7.937254 15.811388 16.941074 17.378147
Tra Vinh           2.828427          7.211103 19.052559 23.790755 22.516660
Tuyen Quang       18.654758         13.416408 15.329710 13.190906 18.411953
Vinh Long         11.532563          5.196152  9.273618 14.177447 12.409674
Vinh Phuc         22.561028         15.588457  9.591663  3.316625 10.295630
Yen Bai           14.899664          6.782330  9.000000 13.490738 15.968719
                   Bac Ninh   Ben Tre Binh Dinh Binh Duong Binh Phuoc
Ba Ria - Vung Tau                                                    
Bac Giang                                                            
Bac Kan                                                              
Bac Lieu                                                             
Bac Ninh                                                             
Ben Tre            6.324555                                          
Binh Dinh         19.416488 14.177447                                
Binh Duong        33.511192 27.622455 15.297059                      
Binh Phuoc        32.171416 26.438608 14.282857   3.741657           
Binh Thuan        28.774989 23.065125 12.288206  11.357817  13.601471
Ca Mau            19.672316 15.066519  9.486833  20.493902  21.023796
Can Tho city       9.539392  6.557439 13.784049  27.856777  27.313001
Cao Bang           8.426150  3.872983 11.747340  25.768197  24.289916
Da Nang city      10.295630  7.348469 14.177447  26.400758  24.310492
Dak Lak            9.746794  3.872983 11.489125  24.124676  22.978251
Dak Nong           9.273618  4.690416 14.525839  26.400758  24.839485
Dien Bien         13.784049  8.124038  6.708204  20.024984  18.627936
Dong Nai          30.083218 24.186773 13.038405   7.745967  10.295630
Dong Thap         13.747727  8.544004 11.045361  22.934690  22.847319
Gia Lai           37.696154 32.078030 18.547237   6.782330   9.165151
Ha Giang          13.341664 10.099505 12.369317  26.172505  25.980762
Ha Nam            15.842980 11.618950  7.348469  21.213203  20.928450
Ha Noi            13.152946  9.433981  8.602325  23.622024  22.847319
Ha Tinh           14.247807 10.344080  8.366600  23.151674  22.494444
Hai Duong         12.884099  9.273618  8.306624  23.558438  22.516660
Hai Phong city    15.716234 13.527749 17.320508  27.239677  24.494897
Hau Giang         10.246951  6.082763 15.811388  26.645825  25.337719
Ho Chi Minh city  19.949937 14.352700  4.582576  13.964240  13.379088
Hoa Binh          18.920888 13.490738 11.180340  17.521415  15.588457
Hung Yen           5.477226  5.830952 16.155494  30.347982  28.618176
Khanh Hoa         19.131126 13.190906  7.810250  15.066519  13.820275
Kien Giang        25.219040 19.287302  9.643651  10.908712  12.124356
Kon Tum           24.289916 18.814888  6.708204  12.369317  13.076697
Lai Chau           9.000000  3.000000 12.884099  25.534291  24.617067
Lam Dong          11.747340 11.045361 15.198684  30.149627  29.410882
Lang Son          10.099505  5.830952 10.816654  24.596748  22.869193
Lao Cai           16.401219 11.180340  7.211103  19.748418  19.697716
Long An           36.083237 30.166206 18.947295   5.000000   7.549834
Nam Dinh           5.291503  9.165151 20.615528  35.369478  34.278273
Nghe An           31.984371 26.362853 13.114877   4.242641   3.464102
Ninh Binh         30.675723 26.248809 16.186414  19.748418  21.587033
Ninh Thuan         7.141428  6.557439 14.764823  29.393877  28.530685
Phu Tho            9.433981  4.582576 10.862780  25.179357  24.207437
Phu Yen           11.000000  8.774964 18.165902  28.740216  26.870058
Quang Binh        21.400935 15.556349 10.246951  14.798649  15.066519
Quang Nam         19.052559 13.379088  7.745967  16.792856  17.088007
Quang Ngai        11.357817  9.433981 17.146428  28.354894  26.115130
Quang Ninh        11.357817 11.180340 16.792856  31.464265  30.951575
Quang Tri         20.639767 15.297059  8.426150  14.594520  12.369317
Soc Trang         13.190906  7.071068  9.327379  21.424285  20.808652
Son La             8.426150  5.196152 13.038405  26.720778  24.939928
Tay Ninh          10.908712  6.244998 12.569805  24.494897  22.671568
Thai Binh          6.000000  9.165151 19.672316  34.190642  32.449961
Thai Nguyen        4.472136  7.745967 19.261360  33.896903  32.878564
Thanh Hoa          6.082763 12.041595 24.859606  39.268308  37.815341
Thua Thien Hue     8.426150 13.527749 25.534291  40.274061  39.038443
Tien Giang        13.416408  7.745967 12.288206  22.293497  20.904545
Tra Vinh          20.273135 14.106736 10.295630  15.684387  15.556349
Tuyen Quang       12.124356  9.746794 14.212670  26.495283  24.124676
Vinh Long         10.677078  5.477226 11.704700  24.515301  23.979158
Vinh Phuc          4.242641  7.874008 18.734994  33.331667  31.701735
Yen Bai           11.958261  7.681146  7.874008  22.847319  21.494185
                  Binh Thuan    Ca Mau Can Tho city  Cao Bang Da Nang city
Ba Ria - Vung Tau                                                         
Bac Giang                                                                 
Bac Kan                                                                   
Bac Lieu                                                                  
Bac Ninh                                                                  
Ben Tre                                                                   
Binh Dinh                                                                 
Binh Duong                                                                
Binh Phuoc                                                                
Binh Thuan                                                                
Ca Mau             11.532563                                              
Can Tho city       21.000000 10.770330                                    
Cao Bang           22.022716 14.282857     7.483315                       
Da Nang city       24.939928 19.104973    13.000000  5.744563             
Dak Lak            20.124612 13.638182     8.124038  4.690416     7.141428
Dak Nong           23.622024 17.578396    10.816654  5.385165     4.690416
Dien Bien          17.029386 11.704700    10.049876  5.744563     8.124038
Dong Nai            4.358899 14.832397    23.237900 23.065125    25.039968
Dong Thap          15.842980  8.124038     6.480741  9.486833    13.892444
Gia Lai            12.767145 22.405357    31.272992 30.033315    31.320920
Ha Giang           18.384776  7.280110     4.123106 10.049876    15.684387
Ha Nam             14.456832  5.477226     8.602325 10.488088    15.000000
Ha Noi             17.748239  8.124038     6.480741  7.615773    12.688578
Ha Tinh            17.000000  7.211103     6.928203  8.485281    13.601471
Hai Duong          18.493242  9.539392     7.416198  6.855655    11.575837
Hai Phong city     28.231188 24.041631    19.026298 11.575837     6.244998
Hau Giang          23.643181 18.275667    11.916375  8.124038     7.416198
Ho Chi Minh city   10.862780 10.344080    14.662878 12.922848    14.764823
Hoa Binh           18.493242 17.972201    17.406895 12.288206    10.488088
Hung Yen           26.870058 18.466185     9.848858  5.000000     6.324555
Khanh Hoa          14.212670 13.964240    15.459625 11.958261    12.247449
Kien Giang          5.291503 11.269428    18.520259 18.411953    20.639767
Kon Tum             5.830952  8.306624    17.000000 17.233688    20.199010
Lai Chau           20.663978 13.416408     6.633250  5.291503     8.660254
Lam Dong           23.452079 12.369317     6.403124 10.246951    15.556349
Lang Son           21.771541 14.866069     9.433981  2.236068     4.690416
Lao Cai            12.609520  4.690416     8.602325 10.488088    14.866069
Long An            13.341664 23.430749    30.675723 28.792360    29.154759
Nam Dinh           29.461840 19.052559     8.660254 10.535654    14.071247
Nghe An            12.041595 19.339080    26.495283 24.041631    24.718414
Ninh Binh          10.535654 11.401754    21.954498 25.019992    29.274562
Ninh Thuan         23.345235 13.416408     4.898979  7.483315    12.041595
Phu Tho            19.874607 11.045361     4.242641  3.741657     9.327379
Phu Yen            27.258026 22.135944    15.297059  9.695360     5.916080
Quang Binh         10.862780 12.449900    16.217275 15.459625    17.029386
Quang Nam          10.049876  7.348469    12.247449 13.038405    16.217275
Quang Ngai         27.549955 22.181073    15.620499  8.717798     3.316625
Quang Ninh         24.062419 12.727922     5.830952 11.401754    16.763055
Quang Tri          16.431677 16.763055    18.138357 13.304135    12.247449
Soc Trang          16.186414  9.949874     7.681146  7.141428    10.770330
Son La             23.853721 16.552945     9.695360  2.449490     3.872983
Tay Ninh           22.561028 17.088007    11.661904  4.898979     3.000000
Thai Binh          30.331502 21.095023    11.704700  8.774964    10.099505
Thai Nguyen        27.928480 17.691806     7.280110  9.433981    13.190906
Thanh Hoa          34.394767 24.617067    14.071247 13.638182    14.933185
Thua Thien Hue     34.539832 24.041631    13.638182 14.899664    17.406895
Tien Giang         20.099751 16.155494    12.369317  7.810250     7.348469
Tra Vinh           12.369317 12.884099    15.297059 13.928388    15.329710
Tuyen Quang        25.709920 19.949937    14.491377  7.071068     3.316625
Vinh Long          18.493242 10.630146     5.385165  7.000000    11.224972
Vinh Phuc          29.223278 19.974984    10.535654  7.937254     9.591663
Yen Bai            18.894444 11.224972     8.124038  4.690416     8.774964
                    Dak Lak  Dak Nong Dien Bien  Dong Nai Dong Thap   Gia Lai
Ba Ria - Vung Tau                                                            
Bac Giang                                                                    
Bac Kan                                                                      
Bac Lieu                                                                     
Bac Ninh                                                                     
Ben Tre                                                                      
Binh Dinh                                                                    
Binh Duong                                                                   
Binh Phuoc                                                                   
Binh Thuan                                                                   
Ca Mau                                                                       
Can Tho city                                                                 
Cao Bang                                                                     
Da Nang city                                                                 
Dak Lak                                                                      
Dak Nong           4.582576                                                  
Dien Bien          5.567764  7.874008                                        
Dong Nai          20.832667 23.979158 17.635192                              
Dong Thap          7.071068 11.000000  8.426150 17.720045                    
Gia Lai           28.774989 31.543621 24.433583 10.488088 26.720778          
Ha Giang          10.535654 13.928388 10.770330 21.142375  6.557439 28.861739
Ha Nam            10.099505 14.247807  8.426150 16.673332  7.071068 23.706539
Ha Noi             9.055385 12.369317  7.416198 19.849433  8.000000 26.419690
Ha Tinh            9.899495 13.152946  7.810250 19.287302  8.124038 25.806976
Hai Duong          8.888194 11.832160  6.782330 20.322401  9.110434 26.476405
Hai Phong city    12.961481 10.049876 12.449900 27.604347 19.544820 32.434549
Hau Giang          5.099020  3.605551  9.643651 23.790755 10.862780 31.968735
Ho Chi Minh city  10.908712 14.282857  7.615773 10.816654 10.148892 18.027756
Hoa Binh          10.148892 10.392305  8.366600 17.117243 13.964240 23.430749
Hung Yen           8.426150  7.348469 10.488088 27.910571 13.601471 34.539832
Khanh Hoa          9.539392 11.489125  6.782330 13.304135 11.090537 20.518285
Kien Giang        15.968719 19.235384 13.190906  5.000000 12.845233 14.730920
Kon Tum           15.968719 19.544820 12.247449  7.681146 12.688578 14.456832
Lai Chau           2.449490  5.196152  7.141428 21.725561  6.164414 30.099834
Lam Dong          12.845233 15.099669 13.038405 26.057628 11.874342 32.603681
Lang Son           5.567764  5.830952  4.898979 22.516660 10.723805 28.930952
Lao Cai            9.165151 13.228757  7.549834 14.764823  4.690416 22.891046
Long An           26.476405 28.774989 23.108440  9.110434 25.159491  8.888194
Nam Dinh          12.767145 13.038405 15.811388 31.448370 14.594520 38.948684
Nghe An           23.065125 25.317978 18.411953  9.486833 22.315914  7.211103
Ninh Binh         24.372115 28.372522 21.424285 14.352700 19.078784 18.055470
Ninh Thuan         8.366600 11.000000 11.000000 25.219040  9.273618 32.710854
Phu Tho            5.099020  7.810250  6.082763 21.494185  6.480741 29.017236
Phu Yen            8.602325  5.000000 11.874342 27.018512 15.297059 34.263683
Quang Binh        11.958261 15.099669 10.862780 10.246951 10.148892 19.621417
Quang Nam         10.392305 14.317821  8.888194 11.401754  6.480741 20.493902
Quang Ngai         9.486833  5.916080 11.090537 27.349589 16.431677 33.615473
Quang Ninh        13.190906 15.652476 14.387495 26.795522 11.489125 33.970576
Quang Tri         11.874342 13.114877  8.366600 14.933185 14.730920 19.974984
Soc Trang          4.582576  8.124038  5.099020 17.349352  3.872983 25.826343
Son La             6.164414  5.196152  7.000000 24.617067 11.832160 31.144823
Tay Ninh           5.099020  3.000000  6.082763 22.715633 11.575837 29.563491
Thai Binh         12.369317 11.045361 14.352700 31.670175 16.703293 38.144462
Thai Nguyen       11.180340 11.916375 14.491377 29.849623 12.922848 37.509999
Thanh Hoa         15.684387 14.456832 19.313208 35.916570 19.235384 43.335897
Thua Thien Hue    17.320508 16.643317 20.469489 36.523965 19.544820 43.954522
Tien Giang         5.000000  4.690416  6.480741 19.974984  9.949874 27.766887
Tra Vinh          10.677078 13.076697  9.433981 11.916375  9.591663 21.023796
Tuyen Quang        9.695360  7.681146  9.000000 25.806976 15.874508 31.144823
Vinh Long          4.358899  8.366600  7.483315 19.974984  3.316625 28.583212
Vinh Phuc         11.000000 10.295630 13.490738 30.545049 15.329710 37.242449
Yen Bai            6.782330  9.327379  4.358899 20.149442  9.055385 26.419690
                   Ha Giang    Ha Nam    Ha Noi   Ha Tinh Hai Duong
Ba Ria - Vung Tau                                                  
Bac Giang                                                          
Bac Kan                                                            
Bac Lieu                                                           
Bac Ninh                                                           
Ben Tre                                                            
Binh Dinh                                                          
Binh Duong                                                         
Binh Phuoc                                                         
Binh Thuan                                                         
Ca Mau                                                             
Can Tho city                                                       
Cao Bang                                                           
Da Nang city                                                       
Dak Lak                                                            
Dak Nong                                                           
Dien Bien                                                          
Dong Nai                                                           
Dong Thap                                                          
Gia Lai                                                            
Ha Giang                                                           
Ha Nam             6.244998                                        
Ha Noi             5.196152  4.242641                              
Ha Tinh            5.000000  4.242641  1.414214                    
Hai Duong          6.782330  5.385165  1.732051  2.645751          
Hai Phong city    21.424285 20.049938 17.832555 18.601075 16.462078
Hau Giang         15.000000 15.099669 14.071247 14.899664 13.820275
Ho Chi Minh city  13.638182  8.544004 10.908712 10.908712 10.954451
Hoa Binh          18.493242 15.394804 15.588457 15.968719 14.966630
Hung Yen          13.038405 14.317821 11.000000 12.041595 10.099505
Khanh Hoa         15.684387 12.041595 13.076697 13.228757 12.806248
Kien Giang        16.792856 12.609520 15.652476 15.198684 16.186414
Kon Tum           14.491377  9.643651 12.688578 12.041595 13.190906
Lai Chau           9.539392 10.488088  9.273618 10.000000  9.433981
Lam Dong           6.164414  9.949874  6.708204  7.000000  7.211103
Lang Son          11.489125 10.908712  8.185353  9.000000  7.071068
Lao Cai            6.708204  3.741657  6.164414  5.830952  7.280110
Long An           29.154759 24.228083 27.000000 26.627054 27.055499
Nam Dinh          11.916375 15.968719 12.845233 13.674794 12.884099
Nghe An           24.718414 19.544820 21.587033 21.118712 21.330729
Ninh Binh         18.083141 15.165751 18.220867 17.262677 19.261360
Ninh Thuan         7.280110  9.486833  7.348469  8.485281  7.681146
Phu Tho            6.403124  7.745967  5.099020  5.830952  5.196152
Phu Yen           18.574176 18.439089 16.792856 17.720045 16.093477
Quang Binh        15.684387 12.041595 14.662878 14.662878 15.099669
Quang Nam         10.908712  7.348469 10.295630 10.099505 11.090537
Quang Ngai        18.627936 18.165902 15.937377 16.852300 14.866069
Quang Ninh         5.916080 10.677078  8.246211  8.602325  9.110434
Quang Tri         18.384776 14.106736 14.730920 15.000000 14.000000
Soc Trang          8.602325  7.937254  7.937254  8.185353  8.366600
Son La            12.369317 12.569805  9.591663 10.488088  8.544004
Tay Ninh          14.177447 13.490738 11.575837 12.328828 10.723805
Thai Binh         14.899664 17.233688 13.527749 14.456832 12.727922
Thai Nguyen       10.677078 14.456832 11.618950 12.529964 11.747340
Thanh Hoa         17.691806 21.071308 17.944358 18.920888 17.635192
Thua Thien Hue    16.822604 21.118712 17.832555 18.601075 17.748239
Tien Giang        14.491377 13.453624 12.767145 13.304135 12.409674
Tra Vinh          15.264338 12.569805 14.282857 14.212670 14.594520
Tuyen Quang       16.763055 15.811388 13.114877 13.928388 11.704700
Vinh Long          7.211103  7.937254  7.681146  8.306624  8.366600
Vinh Phuc         13.784049 15.842980 12.449900 13.527749 11.747340
Yen Bai            8.660254  6.928203  4.242641  5.099020  3.000000
                  Hai Phong city Hau Giang Ho Chi Minh city  Hoa Binh  Hung Yen
Ba Ria - Vung Tau                                                              
Bac Giang                                                                      
Bac Kan                                                                        
Bac Lieu                                                                       
Bac Ninh                                                                       
Ben Tre                                                                        
Binh Dinh                                                                      
Binh Duong                                                                     
Binh Phuoc                                                                     
Binh Thuan                                                                     
Ca Mau                                                                         
Can Tho city                                                                   
Cao Bang                                                                       
Da Nang city                                                                   
Dak Lak                                                                        
Dak Nong                                                                       
Dien Bien                                                                      
Dong Nai                                                                       
Dong Thap                                                                      
Gia Lai                                                                        
Ha Giang                                                                       
Ha Nam                                                                         
Ha Noi                                                                         
Ha Tinh                                                                        
Hai Duong                                                                      
Hai Phong city                                                                 
Hau Giang              12.247449                                               
Ho Chi Minh city       18.083141 14.525839                                     
Hoa Binh               11.618950 10.535654         9.380832                    
Hung Yen               11.445523  9.949874        17.492856 15.937377          
Khanh Hoa              14.798649 11.618950         5.291503  4.472136 16.431677
Kien Giang             23.811762 19.000000         6.782330 13.490738 23.280893
Kon Tum                23.558438 20.074860         6.480741 15.165751 21.908902
Lai Chau               14.628739  5.477226        12.369317 12.041595  8.660254
Lam Dong               20.904545 17.000000        17.549929 21.260292 11.045361
Lang Son                9.949874  8.774964        12.247449 11.045361  5.830952
Lao Cai                19.899749 13.784049         7.280110 13.747727 15.000000
Long An                30.016662 28.442925        16.613248 19.493589 33.376639
Nam Dinh               19.467922 14.456832        21.863211 22.405357  8.124038
Nghe An                25.377155 26.038433        12.922848 16.941074 28.407745
Ninh Binh              33.316662 28.948230        16.941074 25.980762 29.137605
Ninh Thuan             18.055470 11.916375        15.588457 17.972201  8.062258
Phu Tho                15.165751  9.591663        11.958261 13.674794  7.681146
Phu Yen                 8.831761  4.898979        17.406895 11.445523  9.746794
Quang Binh             20.566964 14.106736         6.000000 10.000000 20.049938
Quang Nam              20.688161 14.071247         5.196152 12.124356 17.748239
Quang Ngai              5.099020  7.874008        17.349352 11.532563  8.185353
Quang Ninh             22.494444 17.029386        18.520259 22.338308 12.041595
Quang Tri              13.152946 13.747727         7.211103  4.472136 17.146428
Soc Trang              16.031220  8.544004         8.602325 10.488088 11.832160
Son La                  9.486833  8.366600        14.317821 12.369317  3.872983
Tay Ninh                8.124038  5.830952        12.767145  8.660254  7.549834
Thai Binh              14.177447 13.527749        21.400935 20.049938  4.242641
Thai Nguyen            18.894444 13.076697        20.248457 21.023796  7.615773
Thanh Hoa              19.235384 15.620499        25.826343 24.474477  9.539392
Thua Thien Hue         22.000000 18.055470        26.888659 26.589472 11.445523
Tien Giang             11.357817  4.795832        11.045361  6.480741 11.401754
Tra Vinh               18.708287 12.409674         7.000000  8.306624 18.627936
Tuyen Quang             5.099020 10.677078        15.652476 11.704700  7.141428
Vinh Long              17.175564  8.306624        11.045361 13.190906 10.677078
Vinh Phuc              14.317821 12.369317        20.149442 19.235384  3.464102
Yen Bai                13.638182 11.489125        10.049876 12.369317  8.544004
                  Khanh Hoa Kien Giang   Kon Tum  Lai Chau  Lam Dong  Lang Son
Ba Ria - Vung Tau                                                             
Bac Giang                                                                     
Bac Kan                                                                       
Bac Lieu                                                                      
Bac Ninh                                                                      
Ben Tre                                                                       
Binh Dinh                                                                     
Binh Duong                                                                    
Binh Phuoc                                                                    
Binh Thuan                                                                    
Ca Mau                                                                        
Can Tho city                                                                  
Cao Bang                                                                      
Da Nang city                                                                  
Dak Lak                                                                       
Dak Nong                                                                      
Dien Bien                                                                     
Dong Nai                                                                      
Dong Thap                                                                     
Gia Lai                                                                       
Ha Giang                                                                      
Ha Nam                                                                        
Ha Noi                                                                        
Ha Tinh                                                                       
Hai Duong                                                                     
Hai Phong city                                                                
Hau Giang                                                                     
Ho Chi Minh city                                                              
Hoa Binh                                                                      
Hung Yen                                                                      
Khanh Hoa                                                                     
Kien Giang         9.273618                                                   
Kon Tum           10.862780   5.477226                                        
Lai Chau          11.180340  16.763055 16.822604                              
Lam Dong          19.287302  21.863211 18.814888 12.124356                    
Lang Son          11.045361  18.055470 16.792856  6.855655 11.575837          
Lao Cai           10.049876  10.246951  8.544004  9.273618 11.789826 11.000000
Long An           17.320508  12.727922 15.556349 27.838822 33.585711 27.748874
Nam Dinh          21.863211  26.683328 25.019992 11.532563  8.831761 12.409674
Nghe An           14.525839  11.618950 11.269428 24.617067 28.017851 22.693611
Ninh Binh         21.610183  14.594520 11.000000 24.535688 21.931712 25.119713
Ninh Thuan        16.583124  20.566964 18.788294  7.745967  6.708204  9.219544
Phu Tho           12.124356  16.763055 15.329710  4.690416  8.062258  5.385165
Phu Yen           13.964240  22.472205 23.302360  9.486833 19.313208  9.643651
Quang Binh         6.324555   5.830952  9.486833 12.845233 20.688161 15.297059
Quang Nam          7.937254   6.557439  7.141428 10.862780 16.155494 13.228757
Quang Ngai        14.177447  23.000000 23.043437 10.770330 18.411953  7.937254
Quang Ninh        20.273135  22.472205 19.824228 12.083046  3.000000 13.076697
Quang Tri          4.472136  11.916375 12.569805 13.964240 20.976177 11.747340
Soc Trang          8.124038  12.409674 12.489996  4.582576 12.727922  7.874008
Son La            12.845233  20.074860 18.947295  7.071068 11.789826  2.236068
Tay Ninh           9.949874  18.193405 18.138357  6.633250 15.132746  4.123106
Thai Binh         20.542639  27.055499 25.337719 12.124356 11.401754  9.695360
Thai Nguyen       20.346990  25.059928 23.537205  9.949874  8.366600 11.401754
Thanh Hoa         24.959968  31.064449 29.849623 14.764823 14.594520 15.132746
Thua Thien Hue    26.514147  31.733263 30.116441 16.062378 13.152946 16.583124
Tien Giang         7.348469  15.362291 16.552945  6.244998 17.146428  7.615773
Tra Vinh           5.000000   7.416198 10.723805 11.401754 20.074860 13.747727
Tuyen Quang       13.453624  21.702534 20.663978 11.224972 15.842980  5.385165
Vinh Long         11.224972  15.033296 14.764823  3.316625 11.045361  8.485281
Vinh Phuc         19.544820  25.884358 24.248711 10.816654 10.677078  9.055385
Yen Bai           10.816654  15.842980 13.601471  7.874008  9.327379  4.358899
                    Lao Cai   Long An  Nam Dinh   Nghe An Ninh Binh Ninh Thuan
Ba Ria - Vung Tau                                                             
Bac Giang                                                                     
Bac Kan                                                                       
Bac Lieu                                                                      
Bac Ninh                                                                      
Ben Tre                                                                       
Binh Dinh                                                                     
Binh Duong                                                                    
Binh Phuoc                                                                    
Binh Thuan                                                                    
Ca Mau                                                                        
Can Tho city                                                                  
Cao Bang                                                                      
Da Nang city                                                                  
Dak Lak                                                                       
Dak Nong                                                                      
Dien Bien                                                                     
Dong Nai                                                                      
Dong Thap                                                                     
Gia Lai                                                                       
Ha Giang                                                                      
Ha Nam                                                                        
Ha Noi                                                                        
Ha Tinh                                                                       
Hai Duong                                                                     
Hai Phong city                                                                
Hau Giang                                                                     
Ho Chi Minh city                                                              
Hoa Binh                                                                      
Hung Yen                                                                      
Khanh Hoa                                                                     
Kien Giang                                                                    
Kon Tum                                                                       
Lai Chau                                                                      
Lam Dong                                                                      
Lang Son                                                                      
Lao Cai                                                                       
Long An           22.516660                                                   
Nam Dinh          16.881943 38.288379                                         
Nghe An           18.654758  9.000000 33.630343                               
Ninh Binh         15.297059 22.383029 29.748950 18.814888                     
Ninh Thuan        10.862780 32.140317  7.141428 27.748874 23.958297           
Phu Tho            7.615773 28.160256 10.246951 23.622024 22.135944   5.830952
Phu Yen           17.606817 30.675723 15.779734 27.820855 32.649655  14.491377
Quang Binh         9.433981 15.874508 23.706539 15.459625 18.947295  17.748239
Quang Nam          4.472136 18.894444 20.371549 16.492423 15.556349  14.212670
Quang Ngai        17.832555 30.838288 15.652476 26.870058 32.403703  14.560220
Quang Ninh        12.247449 34.597688  8.062258 29.631065 22.449944   6.164414
Quang Tri         13.076697 17.204651 23.622024 13.304135 23.430749  18.466185
Soc Trang          5.567764 23.874673 14.899664 20.615528 20.663978   9.949874
Son La            12.727922 29.782545 11.090537 24.859606 27.055499   9.055385
Tay Ninh          12.727922 27.147744 14.387495 23.108440 27.386128  11.661904
Thai Binh         18.193405 37.389838  6.633250 32.078030 31.670175   9.848858
Thai Nguyen       15.329710 36.687873  2.000000 32.264532 28.478062   5.385165
Thanh Hoa         21.863211 42.011903  6.082763 37.549967 35.468296  11.916375
Thua Thien Hue    22.000000 43.231933  5.196152 38.470768 34.612137  12.247449
Tien Giang        11.618950 24.372115 16.852300 21.656408 26.210685  13.304135
Tra Vinh           9.486833 17.175564 22.605309 16.186414 20.493902  17.378147
Tuyen Quang       16.062378 29.647934 15.198684 24.372115 29.597297  13.490738
Vinh Long          6.708204 26.795522 12.247449 23.643181 21.702534   7.000000
Vinh Phuc         16.941074 36.359318  5.830952 31.320920 30.577770   7.937254
Yen Bai            7.874008 26.210685 13.076697 20.736441 21.118712   8.124038
                    Phu Tho   Phu Yen Quang Binh Quang Nam Quang Ngai
Ba Ria - Vung Tau                                                    
Bac Giang                                                            
Bac Kan                                                              
Bac Lieu                                                             
Bac Ninh                                                             
Ben Tre                                                              
Binh Dinh                                                            
Binh Duong                                                           
Binh Phuoc                                                           
Binh Thuan                                                           
Ca Mau                                                               
Can Tho city                                                         
Cao Bang                                                             
Da Nang city                                                         
Dak Lak                                                              
Dak Nong                                                             
Dien Bien                                                            
Dong Nai                                                             
Dong Thap                                                            
Gia Lai                                                              
Ha Giang                                                             
Ha Nam                                                               
Ha Noi                                                               
Ha Tinh                                                              
Hai Duong                                                            
Hai Phong city                                                       
Hau Giang                                                            
Ho Chi Minh city                                                     
Hoa Binh                                                             
Hung Yen                                                             
Khanh Hoa                                                            
Kien Giang                                                           
Kon Tum                                                              
Lai Chau                                                             
Lam Dong                                                             
Lang Son                                                             
Lao Cai                                                              
Long An                                                              
Nam Dinh                                                             
Nghe An                                                              
Ninh Binh                                                            
Ninh Thuan                                                           
Phu Tho                                                              
Phu Yen           12.489996                                          
Quang Binh        14.247807 17.748239                                
Quang Nam         10.862780 18.055470   5.196152                     
Quang Ngai        12.247449  4.242641  19.000000 18.814888           
Quang Ninh         8.831761 19.748418  20.952327 16.431677  19.442222
Quang Tri         14.317821 14.730920  10.000000 11.532563  13.964240
Soc Trang          5.385165 12.529964   9.273618  6.708204  13.304135
Son La             6.164414  8.602325  17.000000 15.033296   6.782330
Tay Ninh           7.874008  6.164414  14.525839 13.784049   5.291503
Thai Binh         10.723805 12.922848  24.041631 21.377558  11.269428
Thai Nguyen        8.888194 14.798649  21.954498 18.681542  14.933185
Thanh Hoa         14.696938 15.362291  27.404379 24.859606  15.297059
Thua Thien Hue    15.165751 18.493242  28.618176 25.455844  18.275667
Tien Giang         9.110434  7.416198  11.045361 11.357817   8.660254
Tra Vinh          13.038405 15.937377   3.605551  6.164414  17.146428
Tuyen Quang       10.677078  8.831761  18.788294 17.720045   5.099020
Vinh Long          4.582576 12.529964  11.575837  8.660254  13.674794
Vinh Phuc          9.643651 12.206556  22.671568 20.024984  11.000000
Yen Bai            4.472136 13.416408  14.035669 10.862780  12.083046
                  Quang Ninh Quang Tri Soc Trang    Son La  Tay Ninh Thai Binh
Ba Ria - Vung Tau                                                             
Bac Giang                                                                     
Bac Kan                                                                       
Bac Lieu                                                                      
Bac Ninh                                                                      
Ben Tre                                                                       
Binh Dinh                                                                     
Binh Duong                                                                    
Binh Phuoc                                                                    
Binh Thuan                                                                    
Ca Mau                                                                        
Can Tho city                                                                  
Cao Bang                                                                      
Da Nang city                                                                  
Dak Lak                                                                       
Dak Nong                                                                      
Dien Bien                                                                     
Dong Nai                                                                      
Dong Thap                                                                     
Gia Lai                                                                       
Ha Giang                                                                      
Ha Nam                                                                        
Ha Noi                                                                        
Ha Tinh                                                                       
Hai Duong                                                                     
Hai Phong city                                                                
Hau Giang                                                                     
Ho Chi Minh city                                                              
Hoa Binh                                                                      
Hung Yen                                                                      
Khanh Hoa                                                                     
Kien Giang                                                                    
Kon Tum                                                                       
Lai Chau                                                                      
Lam Dong                                                                      
Lang Son                                                                      
Lao Cai                                                                       
Long An                                                                       
Nam Dinh                                                                      
Nghe An                                                                       
Ninh Binh                                                                     
Ninh Thuan                                                                    
Phu Tho                                                                       
Phu Yen                                                                       
Quang Binh                                                                    
Quang Nam                                                                     
Quang Ngai                                                                    
Quang Ninh                                                                    
Quang Tri          22.383029                                                  
Soc Trang          13.076697 11.575837                                        
Son La             13.114877 13.527749  9.219544                              
Tay Ninh           16.186414 10.816654  8.185353  4.242641                    
Thai Binh          12.288206 21.213203 15.427249  7.810250 11.532563          
Thai Nguyen         7.416198 22.226111 13.341664 10.246951 13.304135  7.211103
Thanh Hoa          14.071247 26.248809 18.894444 13.190906 16.062378  6.855655
Thua Thien Hue     12.409674 28.089144 19.723083 14.899664 18.165902  8.306624
Tien Giang         17.748239  9.695360  6.480741  8.306624  4.582576 15.362291
Tra Vinh           20.493902  9.327379  7.810250 15.362291 12.569805 22.561028
Tuyen Quang        17.549929 12.609520 12.688578  4.898979  5.477226 10.246951
Vinh Long          10.723805 14.352700  3.741657  9.219544  9.219544 13.928388
Vinh Phuc          11.269428 20.346990 14.282857  7.280110 10.908712  2.449490
Yen Bai            11.045361 11.789826  7.141428  6.164414  7.874008 11.874342
                  Thai Nguyen Thanh Hoa Thua Thien Hue Tien Giang  Tra Vinh
Ba Ria - Vung Tau                                                          
Bac Giang                                                                  
Bac Kan                                                                    
Bac Lieu                                                                   
Bac Ninh                                                                   
Ben Tre                                                                    
Binh Dinh                                                                  
Binh Duong                                                                 
Binh Phuoc                                                                 
Binh Thuan                                                                 
Ca Mau                                                                     
Can Tho city                                                               
Cao Bang                                                                   
Da Nang city                                                               
Dak Lak                                                                    
Dak Nong                                                                   
Dien Bien                                                                  
Dong Nai                                                                   
Dong Thap                                                                  
Gia Lai                                                                    
Ha Giang                                                                   
Ha Nam                                                                     
Ha Noi                                                                     
Ha Tinh                                                                    
Hai Duong                                                                  
Hai Phong city                                                             
Hau Giang                                                                  
Ho Chi Minh city                                                           
Hoa Binh                                                                   
Hung Yen                                                                   
Khanh Hoa                                                                  
Kien Giang                                                                 
Kon Tum                                                                    
Lai Chau                                                                   
Lam Dong                                                                   
Lang Son                                                                   
Lao Cai                                                                    
Long An                                                                    
Nam Dinh                                                                   
Nghe An                                                                    
Ninh Binh                                                                  
Ninh Thuan                                                                 
Phu Tho                                                                    
Phu Yen                                                                    
Quang Binh                                                                 
Quang Nam                                                                  
Quang Ngai                                                                 
Quang Ninh                                                                 
Quang Tri                                                                  
Soc Trang                                                                  
Son La                                                                     
Tay Ninh                                                                   
Thai Binh                                                                  
Thai Nguyen                                                                
Thanh Hoa            7.141428                                              
Thua Thien Hue       7.000000  4.242641                                    
Tien Giang          15.491933 18.947295      20.904545                     
Tra Vinh            21.000000 26.115130      27.313001   8.774964          
Tuyen Quang         14.594520 16.062378      18.275667   9.848858 17.088007
Vinh Long           10.488088 16.401219      17.175564   8.366600 10.816654
Vinh Phuc            5.830952  6.708204       8.544004  14.491377 21.470911
Yen Bai             11.874342 17.088007      17.832555   9.848858 13.190906
                  Tuyen Quang Vinh Long Vinh Phuc
Ba Ria - Vung Tau                                
Bac Giang                                        
Bac Kan                                          
Bac Lieu                                         
Bac Ninh                                         
Ben Tre                                          
Binh Dinh                                        
Binh Duong                                       
Binh Phuoc                                       
Binh Thuan                                       
Ca Mau                                           
Can Tho city                                     
Cao Bang                                         
Da Nang city                                     
Dak Lak                                          
Dak Nong                                         
Dien Bien                                        
Dong Nai                                         
Dong Thap                                        
Gia Lai                                          
Ha Giang                                         
Ha Nam                                           
Ha Noi                                           
Ha Tinh                                          
Hai Duong                                        
Hai Phong city                                   
Hau Giang                                        
Ho Chi Minh city                                 
Hoa Binh                                         
Hung Yen                                         
Khanh Hoa                                        
Kien Giang                                       
Kon Tum                                          
Lai Chau                                         
Lam Dong                                         
Lang Son                                         
Lao Cai                                          
Long An                                          
Nam Dinh                                         
Nghe An                                          
Ninh Binh                                        
Ninh Thuan                                       
Phu Tho                                          
Phu Yen                                          
Quang Binh                                       
Quang Nam                                        
Quang Ngai                                       
Quang Ninh                                       
Quang Tri                                        
Soc Trang                                        
Son La                                           
Tay Ninh                                         
Thai Binh                                        
Thai Nguyen                                      
Thanh Hoa                                        
Thua Thien Hue                                   
Tien Giang                                       
Tra Vinh                                         
Tuyen Quang                                      
Vinh Long           13.453624                    
Vinh Phuc           10.246951 12.409674          
Yen Bai              9.055385  7.681146 10.908712</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>hclust_ward <span class="ot">&lt;-</span> <span class="fu">hclust</span>(proxmat, <span class="at">method =</span> <span class="st">'ward.D'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Selecting optimal clustering algorithm</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"average"</span>, <span class="st">"single"</span>, <span class="st">"complete"</span>, <span class="st">"ward"</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>ac <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">agnes</span>(combined_data, <span class="at">method =</span> x)<span class="sc">$</span>ac</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(m, ac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  average    single  complete      ward 
0.7990636 0.6549006 0.9046927 0.9556078 </code></pre>
</div>
</div>
<p>Determining optial Clusters</p>
<p>Elbow method</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(combined_data, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Average silhouette method</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(combined_data, pam, <span class="at">method =</span> <span class="st">"silhouette"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Gap statistic method</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>gap_stat <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(combined_data, </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FUN =</span> hcut, </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nstart =</span> <span class="dv">25</span>, </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K.max =</span> <span class="dv">10</span>, </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">B =</span> <span class="dv">50</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(gap_stat, <span class="at">method =</span> <span class="st">"firstmax"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Clustering Gap statistic ["clusGap"] from call:
clusGap(x = combined_data, FUNcluster = hcut, K.max = 10, B = 50, nstart = 25)
B=50 simulated reference sets, k = 1..10; spaceH0="scaledPCA"
 --&gt; Number of clusters (method 'firstmax'): 1
          logW   E.logW       gap     SE.sim
 [1,] 5.458127 5.735740 0.2776128 0.03370909
 [2,] 5.202773 5.410373 0.2076006 0.03598735
 [3,] 5.030752 5.241643 0.2108909 0.03552918
 [4,] 4.882459 5.101966 0.2195071 0.03683156
 [5,] 4.754387 4.984761 0.2303739 0.03452816
 [6,] 4.668780 4.891612 0.2228321 0.03468526
 [7,] 4.567996 4.811332 0.2433362 0.03632926
 [8,] 4.491539 4.738928 0.2473888 0.03733072
 [9,] 4.425794 4.674183 0.2483894 0.03666931
[10,] 4.374143 4.611648 0.2375050 0.03633215</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_gap_stat</span>(gap_stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Interpreting Dendogram</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_ward, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(hclust_ward, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">k =</span> <span class="dv">3</span>, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Visually-driven hierarchical clustering analysis</p>
<p>transforming the data to matrix</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>combined_data_mat <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(combined_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>plotting interactive cluster heatmap using heatmaply()</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(<span class="fu">normalize</span>(combined_data_mat),</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv=</span><span class="cn">NA</span>,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist_method =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">hclust_method =</span> <span class="st">"ward.D"</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">seriate =</span> <span class="st">"OLO"</span>,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> Blues,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_row =</span> <span class="dv">3</span>,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">200</span>,<span class="dv">60</span>,<span class="cn">NA</span>),</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">4</span>,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_col =</span> <span class="dv">5</span>,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">main=</span><span class="st">"Geographic Segmentation of Vietnam Provinces by PCI indicators"</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"PCI Indicators"</span>,</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Province of Vietnam"</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-0c8bd5cd3a9422faf943" style="width:100%;height:928px;"></div>
<script type="application/json" data-for="htmlwidget-0c8bd5cd3a9422faf943">{"x":{"data":[{"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],"z":[[0,0.80000000000000004,0.17647058823529413,0.5],[0.39393939393939392,1,0.5,0.5],[0.39393939393939392,0.8666666666666667,0.44117647058823528,0.75],[0.51515151515151514,0.66666666666666663,0.41176470588235292,0.5],[0.60606060606060608,0.46666666666666667,0.44117647058823528,0.25],[0.54545454545454541,0.53333333333333333,0.52941176470588236,0.25],[0.66666666666666663,0.66666666666666663,0.52941176470588236,0.25],[0.39393939393939392,0.8666666666666667,0.5,0],[0.36363636363636365,0.73333333333333328,0.29411764705882354,0.25],[0.27272727272727271,0.73333333333333328,0.17647058823529413,0.25],[0.39393939393939392,0.66666666666666663,0.14705882352941177,0],[0.060606060606060608,0.53333333333333333,0.20588235294117646,0],[0.030303030303030304,0.40000000000000002,0.29411764705882354,0],[0.090909090909090912,0.26666666666666666,0.23529411764705882,0],[0.060606060606060608,0.33333333333333331,0.029411764705882353,0.25],[0.60606060606060608,0.26666666666666666,0,0.25],[0.42424242424242425,0.40000000000000002,0.26470588235294118,0.25],[0.42424242424242425,0.20000000000000001,0.44117647058823528,0.25],[0.48484848484848486,0.33333333333333331,0.61764705882352944,0],[0.66666666666666663,0.33333333333333331,0.6470588235294118,0],[0.60606060606060608,0.26666666666666666,0.73529411764705888,0],[0.54545454545454541,0.20000000000000001,0.73529411764705888,0],[0.5757575757575758,0.20000000000000001,0.79411764705882348,0],[0.48484848484848486,0.40000000000000002,0.79411764705882348,0],[0.54545454545454541,0.53333333333333333,0.82352941176470584,0],[0.45454545454545453,0.66666666666666663,0.73529411764705888,0],[0.5757575757575758,0.59999999999999998,0.58823529411764708,0],[0.96969696969696972,0.53333333333333333,0.82352941176470584,0],[0.78787878787878785,0.40000000000000002,0.61764705882352944,0],[0.78787878787878785,0.33333333333333331,0.5,0],[0.66666666666666663,0.40000000000000002,0.3235294117647059,0],[0.66666666666666663,0.13333333333333333,0.5,0],[0.84848484848484851,0,0.58823529411764708,0],[0.90909090909090906,0.13333333333333333,0.58823529411764708,0.25],[0.84848484848484851,0.13333333333333333,0.61764705882352944,0.25],[0.66666666666666663,0.13333333333333333,0.52941176470588236,0.25],[0.63636363636363635,0.066666666666666666,0.55882352941176472,0.25],[0.5757575757575758,0.13333333333333333,0.61764705882352944,0.25],[0.48484848484848486,0.26666666666666666,0.8529411764705882,0.25],[0.45454545454545453,0.33333333333333331,0.94117647058823528,0.25],[0.33333333333333331,0.13333333333333333,0.94117647058823528,0],[0.45454545454545453,0.066666666666666666,0.8529411764705882,0],[0.75757575757575757,0,0.91176470588235292,0],[1,0.13333333333333333,0.94117647058823528,0],[0.90909090909090906,0.20000000000000001,0.82352941176470584,0.25],[0.84848484848484851,0.066666666666666666,0.91176470588235292,0.25],[0.66666666666666663,0.13333333333333333,0.8529411764705882,0.25],[0.75757575757575757,0.066666666666666666,0.88235294117647056,0.5],[0.90909090909090906,0.20000000000000001,1,0.5],[0.87878787878787878,0.26666666666666666,0.79411764705882348,0.5],[0.78787878787878785,0.33333333333333331,0.88235294117647056,0.75],[0.78787878787878785,0.26666666666666666,0.67647058823529416,1],[0.63636363636363635,0.26666666666666666,0.44117647058823528,0.75],[0.39393939393939392,0.46666666666666667,0.44117647058823528,0.75],[0.24242424242424243,0.40000000000000002,0.58823529411764708,0.5],[0.27272727272727271,0.59999999999999998,0.67647058823529416,0.25],[0.33333333333333331,0.59999999999999998,0.55882352941176472,0.25],[0.63636363636363635,0.59999999999999998,0.70588235294117652,0.25],[0.66666666666666663,0.46666666666666667,0.76470588235294112,0.25],[0.66666666666666663,0.59999999999999998,0.61764705882352944,0.5],[0.5757575757575758,0.53333333333333333,0.70588235294117652,0.5],[0.54545454545454541,0.73333333333333328,0.82352941176470584,0.5],[0.48484848484848486,0.59999999999999998,0.94117647058823528,0.5]],"text":[["row: Long An<br>column: security_ind<br>value: 0.00000","row: Long An<br>column: theft_ind<br>value: 0.80000","row: Long An<br>column: police_ind<br>value: 0.17647","row: Long An<br>column: gangster_ind<br>value: 0.50000"],["row: An Giang<br>column: security_ind<br>value: 0.39394","row: An Giang<br>column: theft_ind<br>value: 1.00000","row: An Giang<br>column: police_ind<br>value: 0.50000","row: An Giang<br>column: gangster_ind<br>value: 0.50000"],["row: Quang Binh<br>column: security_ind<br>value: 0.39394","row: Quang Binh<br>column: theft_ind<br>value: 0.86667","row: Quang Binh<br>column: police_ind<br>value: 0.44118","row: Quang Binh<br>column: gangster_ind<br>value: 0.75000"],["row: Quang Nam<br>column: security_ind<br>value: 0.51515","row: Quang Nam<br>column: theft_ind<br>value: 0.66667","row: Quang Nam<br>column: police_ind<br>value: 0.41176","row: Quang Nam<br>column: gangster_ind<br>value: 0.50000"],["row: Lao Cai<br>column: security_ind<br>value: 0.60606","row: Lao Cai<br>column: theft_ind<br>value: 0.46667","row: Lao Cai<br>column: police_ind<br>value: 0.44118","row: Lao Cai<br>column: gangster_ind<br>value: 0.25000"],["row: Ba Ria - Vung Tau<br>column: security_ind<br>value: 0.54545","row: Ba Ria - Vung Tau<br>column: theft_ind<br>value: 0.53333","row: Ba Ria - Vung Tau<br>column: police_ind<br>value: 0.52941","row: Ba Ria - Vung Tau<br>column: gangster_ind<br>value: 0.25000"],["row: Dong Thap<br>column: security_ind<br>value: 0.66667","row: Dong Thap<br>column: theft_ind<br>value: 0.66667","row: Dong Thap<br>column: police_ind<br>value: 0.52941","row: Dong Thap<br>column: gangster_ind<br>value: 0.25000"],["row: Tra Vinh<br>column: security_ind<br>value: 0.39394","row: Tra Vinh<br>column: theft_ind<br>value: 0.86667","row: Tra Vinh<br>column: police_ind<br>value: 0.50000","row: Tra Vinh<br>column: gangster_ind<br>value: 0.00000"],["row: Kien Giang<br>column: security_ind<br>value: 0.36364","row: Kien Giang<br>column: theft_ind<br>value: 0.73333","row: Kien Giang<br>column: police_ind<br>value: 0.29412","row: Kien Giang<br>column: gangster_ind<br>value: 0.25000"],["row: Dong Nai<br>column: security_ind<br>value: 0.27273","row: Dong Nai<br>column: theft_ind<br>value: 0.73333","row: Dong Nai<br>column: police_ind<br>value: 0.17647","row: Dong Nai<br>column: gangster_ind<br>value: 0.25000"],["row: Binh Thuan<br>column: security_ind<br>value: 0.39394","row: Binh Thuan<br>column: theft_ind<br>value: 0.66667","row: Binh Thuan<br>column: police_ind<br>value: 0.14706","row: Binh Thuan<br>column: gangster_ind<br>value: 0.00000"],["row: Binh Duong<br>column: security_ind<br>value: 0.06061","row: Binh Duong<br>column: theft_ind<br>value: 0.53333","row: Binh Duong<br>column: police_ind<br>value: 0.20588","row: Binh Duong<br>column: gangster_ind<br>value: 0.00000"],["row: Binh Phuoc<br>column: security_ind<br>value: 0.03030","row: Binh Phuoc<br>column: theft_ind<br>value: 0.40000","row: Binh Phuoc<br>column: police_ind<br>value: 0.29412","row: Binh Phuoc<br>column: gangster_ind<br>value: 0.00000"],["row: Nghe An<br>column: security_ind<br>value: 0.09091","row: Nghe An<br>column: theft_ind<br>value: 0.26667","row: Nghe An<br>column: police_ind<br>value: 0.23529","row: Nghe An<br>column: gangster_ind<br>value: 0.00000"],["row: Gia Lai<br>column: security_ind<br>value: 0.06061","row: Gia Lai<br>column: theft_ind<br>value: 0.33333","row: Gia Lai<br>column: police_ind<br>value: 0.02941","row: Gia Lai<br>column: gangster_ind<br>value: 0.25000"],["row: Ninh Binh<br>column: security_ind<br>value: 0.60606","row: Ninh Binh<br>column: theft_ind<br>value: 0.26667","row: Ninh Binh<br>column: police_ind<br>value: 0.00000","row: Ninh Binh<br>column: gangster_ind<br>value: 0.25000"],["row: Kon Tum<br>column: security_ind<br>value: 0.42424","row: Kon Tum<br>column: theft_ind<br>value: 0.40000","row: Kon Tum<br>column: police_ind<br>value: 0.26471","row: Kon Tum<br>column: gangster_ind<br>value: 0.25000"],["row: Binh Dinh<br>column: security_ind<br>value: 0.42424","row: Binh Dinh<br>column: theft_ind<br>value: 0.20000","row: Binh Dinh<br>column: police_ind<br>value: 0.44118","row: Binh Dinh<br>column: gangster_ind<br>value: 0.25000"],["row: Dien Bien<br>column: security_ind<br>value: 0.48485","row: Dien Bien<br>column: theft_ind<br>value: 0.33333","row: Dien Bien<br>column: police_ind<br>value: 0.61765","row: Dien Bien<br>column: gangster_ind<br>value: 0.00000"],["row: Phu Tho<br>column: security_ind<br>value: 0.66667","row: Phu Tho<br>column: theft_ind<br>value: 0.33333","row: Phu Tho<br>column: police_ind<br>value: 0.64706","row: Phu Tho<br>column: gangster_ind<br>value: 0.00000"],["row: Cao Bang<br>column: security_ind<br>value: 0.60606","row: Cao Bang<br>column: theft_ind<br>value: 0.26667","row: Cao Bang<br>column: police_ind<br>value: 0.73529","row: Cao Bang<br>column: gangster_ind<br>value: 0.00000"],["row: Lang Son<br>column: security_ind<br>value: 0.54545","row: Lang Son<br>column: theft_ind<br>value: 0.20000","row: Lang Son<br>column: police_ind<br>value: 0.73529","row: Lang Son<br>column: gangster_ind<br>value: 0.00000"],["row: Son La<br>column: security_ind<br>value: 0.57576","row: Son La<br>column: theft_ind<br>value: 0.20000","row: Son La<br>column: police_ind<br>value: 0.79412","row: Son La<br>column: gangster_ind<br>value: 0.00000"],["row: Tay Ninh<br>column: security_ind<br>value: 0.48485","row: Tay Ninh<br>column: theft_ind<br>value: 0.40000","row: Tay Ninh<br>column: police_ind<br>value: 0.79412","row: Tay Ninh<br>column: gangster_ind<br>value: 0.00000"],["row: Dak Nong<br>column: security_ind<br>value: 0.54545","row: Dak Nong<br>column: theft_ind<br>value: 0.53333","row: Dak Nong<br>column: police_ind<br>value: 0.82353","row: Dak Nong<br>column: gangster_ind<br>value: 0.00000"],["row: Tien Giang<br>column: security_ind<br>value: 0.45455","row: Tien Giang<br>column: theft_ind<br>value: 0.66667","row: Tien Giang<br>column: police_ind<br>value: 0.73529","row: Tien Giang<br>column: gangster_ind<br>value: 0.00000"],["row: Soc Trang<br>column: security_ind<br>value: 0.57576","row: Soc Trang<br>column: theft_ind<br>value: 0.60000","row: Soc Trang<br>column: police_ind<br>value: 0.58824","row: Soc Trang<br>column: gangster_ind<br>value: 0.00000"],["row: Bac Lieu<br>column: security_ind<br>value: 0.96970","row: Bac Lieu<br>column: theft_ind<br>value: 0.53333","row: Bac Lieu<br>column: police_ind<br>value: 0.82353","row: Bac Lieu<br>column: gangster_ind<br>value: 0.00000"],["row: Can Tho city<br>column: security_ind<br>value: 0.78788","row: Can Tho city<br>column: theft_ind<br>value: 0.40000","row: Can Tho city<br>column: police_ind<br>value: 0.61765","row: Can Tho city<br>column: gangster_ind<br>value: 0.00000"],["row: Ha Giang<br>column: security_ind<br>value: 0.78788","row: Ha Giang<br>column: theft_ind<br>value: 0.33333","row: Ha Giang<br>column: police_ind<br>value: 0.50000","row: Ha Giang<br>column: gangster_ind<br>value: 0.00000"],["row: Ca Mau<br>column: security_ind<br>value: 0.66667","row: Ca Mau<br>column: theft_ind<br>value: 0.40000","row: Ca Mau<br>column: police_ind<br>value: 0.32353","row: Ca Mau<br>column: gangster_ind<br>value: 0.00000"],["row: Ha Tinh<br>column: security_ind<br>value: 0.66667","row: Ha Tinh<br>column: theft_ind<br>value: 0.13333","row: Ha Tinh<br>column: police_ind<br>value: 0.50000","row: Ha Tinh<br>column: gangster_ind<br>value: 0.00000"],["row: Lam Dong<br>column: security_ind<br>value: 0.84848","row: Lam Dong<br>column: theft_ind<br>value: 0.00000","row: Lam Dong<br>column: police_ind<br>value: 0.58824","row: Lam Dong<br>column: gangster_ind<br>value: 0.00000"],["row: Quang Ninh<br>column: security_ind<br>value: 0.90909","row: Quang Ninh<br>column: theft_ind<br>value: 0.13333","row: Quang Ninh<br>column: police_ind<br>value: 0.58824","row: Quang Ninh<br>column: gangster_ind<br>value: 0.25000"],["row: Bac Giang<br>column: security_ind<br>value: 0.84848","row: Bac Giang<br>column: theft_ind<br>value: 0.13333","row: Bac Giang<br>column: police_ind<br>value: 0.61765","row: Bac Giang<br>column: gangster_ind<br>value: 0.25000"],["row: Ha Noi<br>column: security_ind<br>value: 0.66667","row: Ha Noi<br>column: theft_ind<br>value: 0.13333","row: Ha Noi<br>column: police_ind<br>value: 0.52941","row: Ha Noi<br>column: gangster_ind<br>value: 0.25000"],["row: Hai Duong<br>column: security_ind<br>value: 0.63636","row: Hai Duong<br>column: theft_ind<br>value: 0.06667","row: Hai Duong<br>column: police_ind<br>value: 0.55882","row: Hai Duong<br>column: gangster_ind<br>value: 0.25000"],["row: Yen Bai<br>column: security_ind<br>value: 0.57576","row: Yen Bai<br>column: theft_ind<br>value: 0.13333","row: Yen Bai<br>column: police_ind<br>value: 0.61765","row: Yen Bai<br>column: gangster_ind<br>value: 0.25000"],["row: Da Nang city<br>column: security_ind<br>value: 0.48485","row: Da Nang city<br>column: theft_ind<br>value: 0.26667","row: Da Nang city<br>column: police_ind<br>value: 0.85294","row: Da Nang city<br>column: gangster_ind<br>value: 0.25000"],["row: Quang Ngai<br>column: security_ind<br>value: 0.45455","row: Quang Ngai<br>column: theft_ind<br>value: 0.33333","row: Quang Ngai<br>column: police_ind<br>value: 0.94118","row: Quang Ngai<br>column: gangster_ind<br>value: 0.25000"],["row: Hai Phong city<br>column: security_ind<br>value: 0.33333","row: Hai Phong city<br>column: theft_ind<br>value: 0.13333","row: Hai Phong city<br>column: police_ind<br>value: 0.94118","row: Hai Phong city<br>column: gangster_ind<br>value: 0.00000"],["row: Tuyen Quang<br>column: security_ind<br>value: 0.45455","row: Tuyen Quang<br>column: theft_ind<br>value: 0.06667","row: Tuyen Quang<br>column: police_ind<br>value: 0.85294","row: Tuyen Quang<br>column: gangster_ind<br>value: 0.00000"],["row: Thai Binh<br>column: security_ind<br>value: 0.75758","row: Thai Binh<br>column: theft_ind<br>value: 0.00000","row: Thai Binh<br>column: police_ind<br>value: 0.91176","row: Thai Binh<br>column: gangster_ind<br>value: 0.00000"],["row: Thua Thien Hue<br>column: security_ind<br>value: 1.00000","row: Thua Thien Hue<br>column: theft_ind<br>value: 0.13333","row: Thua Thien Hue<br>column: police_ind<br>value: 0.94118","row: Thua Thien Hue<br>column: gangster_ind<br>value: 0.00000"],["row: Nam Dinh<br>column: security_ind<br>value: 0.90909","row: Nam Dinh<br>column: theft_ind<br>value: 0.20000","row: Nam Dinh<br>column: police_ind<br>value: 0.82353","row: Nam Dinh<br>column: gangster_ind<br>value: 0.25000"],["row: Bac Kan<br>column: security_ind<br>value: 0.84848","row: Bac Kan<br>column: theft_ind<br>value: 0.06667","row: Bac Kan<br>column: police_ind<br>value: 0.91176","row: Bac Kan<br>column: gangster_ind<br>value: 0.25000"],["row: Hung Yen<br>column: security_ind<br>value: 0.66667","row: Hung Yen<br>column: theft_ind<br>value: 0.13333","row: Hung Yen<br>column: police_ind<br>value: 0.85294","row: Hung Yen<br>column: gangster_ind<br>value: 0.25000"],["row: Vinh Phuc<br>column: security_ind<br>value: 0.75758","row: Vinh Phuc<br>column: theft_ind<br>value: 0.06667","row: Vinh Phuc<br>column: police_ind<br>value: 0.88235","row: Vinh Phuc<br>column: gangster_ind<br>value: 0.50000"],["row: Thanh Hoa<br>column: security_ind<br>value: 0.90909","row: Thanh Hoa<br>column: theft_ind<br>value: 0.20000","row: Thanh Hoa<br>column: police_ind<br>value: 1.00000","row: Thanh Hoa<br>column: gangster_ind<br>value: 0.50000"],["row: Thai Nguyen<br>column: security_ind<br>value: 0.87879","row: Thai Nguyen<br>column: theft_ind<br>value: 0.26667","row: Thai Nguyen<br>column: police_ind<br>value: 0.79412","row: Thai Nguyen<br>column: gangster_ind<br>value: 0.50000"],["row: Bac Ninh<br>column: security_ind<br>value: 0.78788","row: Bac Ninh<br>column: theft_ind<br>value: 0.33333","row: Bac Ninh<br>column: police_ind<br>value: 0.88235","row: Bac Ninh<br>column: gangster_ind<br>value: 0.75000"],["row: Ninh Thuan<br>column: security_ind<br>value: 0.78788","row: Ninh Thuan<br>column: theft_ind<br>value: 0.26667","row: Ninh Thuan<br>column: police_ind<br>value: 0.67647","row: Ninh Thuan<br>column: gangster_ind<br>value: 1.00000"],["row: Ha Nam<br>column: security_ind<br>value: 0.63636","row: Ha Nam<br>column: theft_ind<br>value: 0.26667","row: Ha Nam<br>column: police_ind<br>value: 0.44118","row: Ha Nam<br>column: gangster_ind<br>value: 0.75000"],["row: Ho Chi Minh city<br>column: security_ind<br>value: 0.39394","row: Ho Chi Minh city<br>column: theft_ind<br>value: 0.46667","row: Ho Chi Minh city<br>column: police_ind<br>value: 0.44118","row: Ho Chi Minh city<br>column: gangster_ind<br>value: 0.75000"],["row: Quang Tri<br>column: security_ind<br>value: 0.24242","row: Quang Tri<br>column: theft_ind<br>value: 0.40000","row: Quang Tri<br>column: police_ind<br>value: 0.58824","row: Quang Tri<br>column: gangster_ind<br>value: 0.50000"],["row: Hoa Binh<br>column: security_ind<br>value: 0.27273","row: Hoa Binh<br>column: theft_ind<br>value: 0.60000","row: Hoa Binh<br>column: police_ind<br>value: 0.67647","row: Hoa Binh<br>column: gangster_ind<br>value: 0.25000"],["row: Khanh Hoa<br>column: security_ind<br>value: 0.33333","row: Khanh Hoa<br>column: theft_ind<br>value: 0.60000","row: Khanh Hoa<br>column: police_ind<br>value: 0.55882","row: Khanh Hoa<br>column: gangster_ind<br>value: 0.25000"],["row: Lai Chau<br>column: security_ind<br>value: 0.63636","row: Lai Chau<br>column: theft_ind<br>value: 0.60000","row: Lai Chau<br>column: police_ind<br>value: 0.70588","row: Lai Chau<br>column: gangster_ind<br>value: 0.25000"],["row: Ben Tre<br>column: security_ind<br>value: 0.66667","row: Ben Tre<br>column: theft_ind<br>value: 0.46667","row: Ben Tre<br>column: police_ind<br>value: 0.76471","row: Ben Tre<br>column: gangster_ind<br>value: 0.25000"],["row: Vinh Long<br>column: security_ind<br>value: 0.66667","row: Vinh Long<br>column: theft_ind<br>value: 0.60000","row: Vinh Long<br>column: police_ind<br>value: 0.61765","row: Vinh Long<br>column: gangster_ind<br>value: 0.50000"],["row: Dak Lak<br>column: security_ind<br>value: 0.57576","row: Dak Lak<br>column: theft_ind<br>value: 0.53333","row: Dak Lak<br>column: police_ind<br>value: 0.70588","row: Dak Lak<br>column: gangster_ind<br>value: 0.50000"],["row: Hau Giang<br>column: security_ind<br>value: 0.54545","row: Hau Giang<br>column: theft_ind<br>value: 0.73333","row: Hau Giang<br>column: police_ind<br>value: 0.82353","row: Hau Giang<br>column: gangster_ind<br>value: 0.50000"],["row: Phu Yen<br>column: security_ind<br>value: 0.48485","row: Phu Yen<br>column: theft_ind<br>value: 0.60000","row: Phu Yen<br>column: police_ind<br>value: 0.94118","row: Phu Yen<br>column: gangster_ind<br>value: 0.50000"]],"colorscale":[[0,"#F7FBFF"],[0.029411764705882353,"#F0F6FC"],[0.030303030303030304,"#F0F6FC"],[0.060606060606060608,"#EBF3FB"],[0.066666666666666666,"#E9F2FA"],[0.090909090909090912,"#E4EFF9"],[0.13333333333333333,"#DCE9F6"],[0.14705882352941177,"#DAE7F5"],[0.17647058823529413,"#D4E4F3"],[0.20000000000000001,"#CFE1F2"],[0.20588235294117646,"#CEE0F1"],[0.23529411764705882,"#C8DCEF"],[0.24242424242424243,"#C7DBEF"],[0.25,"#C5DAEE"],[0.26470588235294118,"#C1D8ED"],[0.26666666666666666,"#C0D8ED"],[0.27272727272727271,"#BED7EC"],[0.29411764705882354,"#B7D4EA"],[0.3235294117647059,"#AED0E6"],[0.33333333333333331,"#ABCFE5"],[0.36363636363636365,"#A1CBE2"],[0.39393939393939392,"#96C6DF"],[0.40000000000000002,"#93C4DE"],[0.41176470588235292,"#8FC1DD"],[0.42424242424242425,"#8ABFDC"],[0.44117647058823528,"#83BADB"],[0.45454545454545453,"#7DB8D9"],[0.46666666666666667,"#78B5D8"],[0.48484848484848486,"#71B1D7"],[0.5,"#6BADD5"],[0.51515151515151514,"#66AAD4"],[0.52941176470588236,"#61A7D2"],[0.53333333333333333,"#60A6D1"],[0.54545454545454541,"#5CA3D0"],[0.55882352941176472,"#58A0CE"],[0.5757575757575758,"#519CCC"],[0.58823529411764708,"#4E9ACA"],[0.59999999999999998,"#4A97C9"],[0.60606060606060608,"#4795C8"],[0.61764705882352944,"#4493C6"],[0.63636363636363635,"#3F8FC4"],[0.6470588235294118,"#3C8CC3"],[0.66666666666666663,"#3787C0"],[0.67647058823529416,"#3483BE"],[0.70588235294117652,"#2C7CBB"],[0.73333333333333328,"#2575B7"],[0.73529411764705888,"#2574B6"],[0.75,"#2171B5"],[0.75757575757575757,"#1F6FB3"],[0.76470588235294112,"#1E6DB2"],[0.78787878787878785,"#1967AD"],[0.79411764705882348,"#1865AB"],[0.80000000000000004,"#1664AB"],[0.82352941176470584,"#125EA6"],[0.84848484848484851,"#0D58A1"],[0.8529411764705882,"#0C57A0"],[0.8666666666666667,"#09539D"],[0.87878787878787878,"#08509A"],[0.88235294117647056,"#084F99"],[0.90909090909090906,"#08478E"],[0.91176470588235292,"#08468D"],[0.94117647058823528,"#083F82"],[0.96969696969696972,"#083876"],[1,"#08306B"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"a744337bfb1ddd31a0fd489a48f1f013","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#F7FBFF"],[0.0033444816053511705,"#F6FAFE"],[0.006688963210702341,"#F5F9FE"],[0.010033444816053512,"#F4F9FE"],[0.013377926421404682,"#F4F9FE"],[0.016722408026755852,"#F3F8FD"],[0.020066889632107024,"#F3F8FD"],[0.023411371237458192,"#F2F7FD"],[0.026755852842809364,"#F1F7FD"],[0.030100334448160536,"#F0F6FC"],[0.033444816053511704,"#EFF6FC"],[0.036789297658862873,"#EFF6FC"],[0.040133779264214048,"#EFF5FC"],[0.043478260869565216,"#EEF5FC"],[0.046822742474916385,"#EDF4FB"],[0.05016722408026756,"#ECF4FB"],[0.053511705685618728,"#ECF3FB"],[0.056856187290969896,"#ECF3FB"],[0.060200668896321072,"#EBF3FB"],[0.06354515050167224,"#EAF2FA"],[0.066889632107023408,"#E9F2FA"],[0.070234113712374577,"#E8F1FA"],[0.073578595317725745,"#E8F1FA"],[0.076923076923076927,"#E7F0F9"],[0.080267558528428096,"#E7F0F9"],[0.083612040133779264,"#E6F0F9"],[0.086956521739130432,"#E5EFF9"],[0.090301003344481601,"#E4EFF9"],[0.093645484949832769,"#E4EEF8"],[0.096989966555183951,"#E3EEF8"],[0.10033444816053512,"#E2EDF8"],[0.10367892976588629,"#E2EDF8"],[0.10702341137123746,"#E1EDF8"],[0.11036789297658862,"#E1ECF7"],[0.11371237458193979,"#E0ECF7"],[0.11705685618729096,"#DFEBF7"],[0.12040133779264214,"#DEEBF7"],[0.12374581939799331,"#DDEAF6"],[0.12709030100334448,"#DDEAF6"],[0.13043478260869565,"#DDEAF6"],[0.13377926421404682,"#DCE9F6"],[0.13712374581939799,"#DBE9F6"],[0.14046822742474915,"#DAE8F5"],[0.14381270903010032,"#DAE8F5"],[0.14715719063545149,"#D9E7F5"],[0.15050167224080269,"#D9E7F5"],[0.15384615384615385,"#D8E7F5"],[0.15719063545150502,"#D7E6F4"],[0.16053511705685619,"#D7E6F4"],[0.16387959866220736,"#D6E5F4"],[0.16722408026755853,"#D5E5F4"],[0.1705685618729097,"#D5E5F4"],[0.17391304347826086,"#D4E4F3"],[0.17725752508361203,"#D4E4F3"],[0.1806020066889632,"#D3E3F3"],[0.18394648829431437,"#D2E3F3"],[0.18729096989966554,"#D1E2F2"],[0.19063545150501671,"#D1E2F2"],[0.1939799331103679,"#D1E2F2"],[0.19732441471571907,"#D0E1F2"],[0.20066889632107024,"#CFE1F2"],[0.20401337792642141,"#CEE0F1"],[0.20735785953177258,"#CEE0F1"],[0.21070234113712374,"#CDDFF1"],[0.21404682274247491,"#CCDFF1"],[0.21739130434782608,"#CCDFF1"],[0.22073578595317725,"#CBDEF0"],[0.22408026755852842,"#CBDEF0"],[0.22742474916387959,"#CADDF0"],[0.23076923076923075,"#C9DDF0"],[0.23411371237458192,"#C8DCEF"],[0.23745819397993312,"#C8DCEF"],[0.24080267558528429,"#C8DCEF"],[0.24414715719063546,"#C7DBEF"],[0.24749163879598662,"#C6DBEF"],[0.25083612040133779,"#C5DAEE"],[0.25418060200668896,"#C4DAEE"],[0.25752508361204013,"#C3D9EE"],[0.2608695652173913,"#C2D9ED"],[0.26421404682274247,"#C1D9ED"],[0.26755852842809363,"#C0D8ED"],[0.2709030100334448,"#BFD8EC"],[0.27424749163879597,"#BED7EC"],[0.27759197324414714,"#BCD7EB"],[0.28093645484949831,"#BBD6EB"],[0.28428093645484948,"#BBD6EB"],[0.28762541806020064,"#BAD6EA"],[0.29096989966555181,"#B9D5EA"],[0.29431438127090298,"#B7D4EA"],[0.29765886287625415,"#B6D4E9"],[0.30100334448160537,"#B5D3E9"],[0.30434782608695654,"#B4D3E8"],[0.30769230769230771,"#B3D3E8"],[0.31103678929765888,"#B2D2E8"],[0.31438127090301005,"#B1D2E7"],[0.31772575250836121,"#B0D1E7"],[0.32107023411371238,"#AFD1E6"],[0.32441471571906355,"#AED0E6"],[0.32775919732441472,"#ACD0E6"],[0.33110367892976589,"#ACD0E6"],[0.33444816053511706,"#ABCFE5"],[0.33779264214046822,"#AACFE5"],[0.34113712374581939,"#A8CEE4"],[0.34448160535117056,"#A7CEE4"],[0.34782608695652173,"#A6CDE3"],[0.3511705685618729,"#A5CDE3"],[0.35451505016722407,"#A4CDE3"],[0.35785953177257523,"#A3CCE3"],[0.3612040133779264,"#A2CBE2"],[0.36454849498327757,"#A1CBE2"],[0.36789297658862874,"#A0CAE1"],[0.37123745819397991,"#9FCAE1"],[0.37458193979933108,"#9DC9E0"],[0.37792642140468224,"#9CC9E0"],[0.38127090301003341,"#9BC8E0"],[0.38461538461538458,"#9AC7E0"],[0.38795986622073581,"#98C7DF"],[0.39130434782608697,"#97C6DF"],[0.39464882943143814,"#96C5DF"],[0.39799331103678931,"#94C5DF"],[0.40133779264214048,"#93C4DE"],[0.40468227424749165,"#92C3DE"],[0.40802675585284282,"#90C2DE"],[0.41137123745819398,"#8FC1DD"],[0.41471571906354515,"#8DC0DD"],[0.41806020066889632,"#8CC0DD"],[0.42140468227424749,"#8BC0DD"],[0.42474916387959866,"#89BFDC"],[0.42809364548494983,"#88BEDC"],[0.43143812709030099,"#87BDDC"],[0.43478260869565216,"#85BCDB"],[0.43812709030100333,"#84BBDB"],[0.4414715719063545,"#82BADB"],[0.44481605351170567,"#81BADB"],[0.44816053511705684,"#80B9DA"],[0.451505016722408,"#7FB8DA"],[0.45484949832775917,"#7DB8D9"],[0.45819397993311034,"#7BB7D9"],[0.46153846153846151,"#7AB6D9"],[0.46488294314381268,"#79B5D8"],[0.46822742474916385,"#78B5D8"],[0.47157190635451507,"#77B4D8"],[0.47491638795986624,"#75B3D8"],[0.47826086956521741,"#73B2D7"],[0.48160535117056857,"#72B1D7"],[0.48494983277591974,"#71B1D7"],[0.48829431438127091,"#6FB0D6"],[0.49163879598662208,"#6EB0D6"],[0.49498327759197325,"#6DAFD6"],[0.49832775919732442,"#6BAED6"],[0.50167224080267558,"#6AADD5"],[0.50501672240802675,"#69ACD5"],[0.50836120401337792,"#68ABD4"],[0.51170568561872909,"#67ABD4"],[0.51505016722408026,"#66AAD4"],[0.51839464882943143,"#65AAD3"],[0.52173913043478259,"#63A9D3"],[0.52508361204013376,"#62A8D2"],[0.52842809364548493,"#61A7D2"],[0.5317725752508361,"#60A6D1"],[0.53511705685618727,"#5FA6D1"],[0.53846153846153844,"#5EA5D1"],[0.5418060200668896,"#5DA4D0"],[0.54515050167224077,"#5CA3D0"],[0.54849498327759194,"#5AA3CF"],[0.55183946488294311,"#59A2CF"],[0.55518394648829428,"#58A1CE"],[0.55852842809364545,"#58A1CE"],[0.56187290969899661,"#56A0CE"],[0.56521739130434778,"#559FCD"],[0.56856187290969895,"#549ECD"],[0.57190635451505012,"#539DCC"],[0.57525083612040129,"#529CCC"],[0.57859531772575246,"#509BCB"],[0.58193979933110362,"#509BCB"],[0.58528428093645479,"#4F9BCB"],[0.58862876254180596,"#4E9ACA"],[0.59197324414715713,"#4C99CA"],[0.5953177257525083,"#4B98C9"],[0.59866220735785947,"#4A97C9"],[0.60200668896321075,"#4996C8"],[0.60535117056856191,"#4896C8"],[0.60869565217391308,"#4795C8"],[0.61204013377926425,"#4694C7"],[0.61538461538461542,"#4594C7"],[0.61872909698996659,"#4393C6"],[0.62207357859531776,"#4292C6"],[0.62541806020066892,"#4292C6"],[0.62876254180602009,"#4191C5"],[0.63210702341137126,"#4090C5"],[0.63545150501672243,"#3F8FC4"],[0.6387959866220736,"#3E8EC4"],[0.64214046822742477,"#3D8DC3"],[0.64548494983277593,"#3C8CC3"],[0.6488294314381271,"#3C8CC3"],[0.65217391304347827,"#3B8BC2"],[0.65551839464882944,"#3A8AC1"],[0.65886287625418061,"#3989C1"],[0.66220735785953178,"#3888C0"],[0.66555183946488294,"#3787C0"],[0.66889632107023411,"#3686BF"],[0.67224080267558528,"#3585BF"],[0.67558528428093645,"#3484BF"],[0.67892976588628762,"#3383BE"],[0.68227424749163879,"#3282BE"],[0.68561872909698995,"#3181BD"],[0.68896321070234112,"#3080BD"],[0.69230769230769229,"#2F7FBC"],[0.69565217391304346,"#2F7FBC"],[0.69899665551839463,"#2E7EBC"],[0.7023411371237458,"#2D7DBB"],[0.70568561872909696,"#2C7CBB"],[0.70903010033444813,"#2B7BBA"],[0.7123745819397993,"#2A7AB9"],[0.71571906354515047,"#2979B9"],[0.71906354515050164,"#2979B9"],[0.72240802675585281,"#2878B8"],[0.72575250836120397,"#2777B8"],[0.72909698996655514,"#2676B7"],[0.73244147157190631,"#2575B7"],[0.73578595317725748,"#2474B6"],[0.73913043478260865,"#2474B6"],[0.74247491638795982,"#2373B6"],[0.74581939799331098,"#2272B5"],[0.74916387959866215,"#2171B5"],[0.75250836120401332,"#2070B4"],[0.75585284280936449,"#1F6FB3"],[0.75919732441471566,"#1E6EB2"],[0.76254180602006683,"#1E6EB2"],[0.76588628762541799,"#1E6DB2"],[0.76923076923076916,"#1D6CB1"],[0.77257525083612044,"#1C6BB0"],[0.77591973244147161,"#1B6AAF"],[0.77926421404682278,"#1A69AE"],[0.78260869565217395,"#1A68AE"],[0.78595317725752512,"#1A68AE"],[0.78929765886287628,"#1967AD"],[0.79264214046822745,"#1866AC"],[0.79598662207357862,"#1765AB"],[0.79933110367892979,"#1664AB"],[0.80267558528428096,"#1663AA"],[0.80602006688963213,"#1562A9"],[0.80936454849498329,"#1562A9"],[0.81270903010033446,"#1461A8"],[0.81605351170568563,"#1360A7"],[0.8193979933110368,"#135FA7"],[0.82274247491638797,"#125EA6"],[0.82608695652173914,"#115DA5"],[0.8294314381270903,"#105CA4"],[0.83277591973244147,"#105CA4"],[0.83612040133779264,"#0F5BA3"],[0.83946488294314381,"#0F5AA3"],[0.84280936454849498,"#0E59A2"],[0.84615384615384615,"#0D58A1"],[0.84949832775919731,"#0C57A0"],[0.85284280936454848,"#0C57A0"],[0.85618729096989965,"#0C56A0"],[0.85953177257525082,"#0B559F"],[0.86287625418060199,"#0A549E"],[0.86622073578595316,"#09539D"],[0.86956521739130432,"#08529C"],[0.87290969899665549,"#08519C"],[0.87625418060200666,"#08519B"],[0.87959866220735783,"#08509A"],[0.882943143812709,"#084F99"],[0.88628762541806017,"#084E97"],[0.88963210702341133,"#084C96"],[0.8929765886287625,"#084B95"],[0.89632107023411367,"#084A93"],[0.89966555183946484,"#084A92"],[0.90301003344481601,"#084990"],[0.90635451505016718,"#08488F"],[0.90969899665551834,"#08478E"],[0.91304347826086951,"#08468C"],[0.91638795986622068,"#08458B"],[0.91973244147157185,"#08448A"],[0.92307692307692302,"#084489"],[0.92642140468227419,"#084388"],[0.92976588628762535,"#084286"],[0.93311036789297652,"#084185"],[0.93645484949832769,"#084083"],[0.93979933110367886,"#083F82"],[0.94314381270903014,"#083E81"],[0.94648829431438131,"#083E7F"],[0.94983277591973247,"#083D7E"],[0.95317725752508364,"#083C7D"],[0.95652173913043481,"#083B7B"],[0.95986622073578598,"#083A7A"],[0.96321070234113715,"#083979"],[0.96655518394648832,"#083978"],[0.96989966555183948,"#083876"],[0.97324414715719065,"#083775"],[0.97658862876254182,"#083674"],[0.97993311036789299,"#083572"],[0.98327759197324416,"#083471"],[0.98662207357859533,"#083370"],[0.98996655518394649,"#08336F"],[0.99331103678929766,"#08326D"],[0.99665551839464883,"#08316C"],[1,"#08306B"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"thickness":23.039999999999996,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0.0016666666666666668,0.2508333333333333,0.49999999999999994,0.74916666666666665,0.99833333333333329],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.1377427442871084,1.1377427442871084,null,1.1377427442871084,0.96901609618933204,null,0.96901609618933204,0.96901609618933204,null,0.96901609618933204,0.60630248397627962,null,0.60630248397627962,0.60630248397627962,null,0.60630248397627962,0.33065387899893084,null,0.33065387899893084,0.33065387899893084,null,0.33065387899893084,0,null,0.33065387899893084,0.33065387899893084,null,0.33065387899893084,0,null,0.60630248397627962,0.60630248397627962,null,0.60630248397627962,0.31427617363549509,null,0.31427617363549509,0.31427617363549509,null,0.31427617363549509,0,null,0.31427617363549509,0.31427617363549509,null,0.31427617363549509,0,null,0.96901609618933204,0.96901609618933204,null,0.96901609618933204,0.52732148399590562,null,0.52732148399590562,0.52732148399590562,null,0.52732148399590562,0.33411003384069671,null,0.33411003384069671,0.33411003384069671,null,0.33411003384069671,0,null,0.33411003384069671,0.33411003384069671,null,0.33411003384069671,0.13234018676128761,null,0.13234018676128761,0.13234018676128761,null,0.13234018676128761,0,null,0.13234018676128761,0.13234018676128761,null,0.13234018676128761,0,null,0.52732148399590562,0.52732148399590562,null,0.52732148399590562,0.3895686037815545,null,0.3895686037815545,0.3895686037815545,null,0.3895686037815545,0.31922417727301361,null,0.31922417727301361,0.31922417727301361,null,0.31922417727301361,0.14884978681805652,null,0.14884978681805652,0.14884978681805652,null,0.14884978681805652,0,null,0.14884978681805652,0.14884978681805652,null,0.14884978681805652,0,null,0.31922417727301361,0.31922417727301361,null,0.31922417727301361,0.14315856377593858,null,0.14315856377593858,0.14315856377593858,null,0.14315856377593858,0,null,0.14315856377593858,0.14315856377593858,null,0.14315856377593858,0,null,0.3895686037815545,0.3895686037815545,null,0.3895686037815545,0.18786086023914148,null,0.18786086023914148,0.18786086023914148,null,0.18786086023914148,0,null,0.18786086023914148,0.18786086023914148,null,0.18786086023914148,0],"y":[46.830078125,55.4375,null,55.4375,55.4375,null,55.4375,52.5,null,52.5,52.5,null,52.5,51.5,null,51.5,51.5,null,51.5,51,null,51,51,null,51.5,52,null,52,52,null,52.5,53.5,null,53.5,53.5,null,53.5,53,null,53,53,null,53.5,54,null,54,54,null,55.4375,58.375,null,58.375,58.375,null,58.375,55.75,null,55.75,55.75,null,55.75,55,null,55,55,null,55.75,56.5,null,56.5,56.5,null,56.5,56,null,56,56,null,56.5,57,null,57,57,null,58.375,61,null,61,61,null,61,59.5,null,59.5,59.5,null,59.5,58.5,null,58.5,58.5,null,58.5,58,null,58,58,null,58.5,59,null,59,59,null,59.5,60.5,null,60.5,60.5,null,60.5,60,null,60,60,null,60.5,61,null,61,61,null,61,62.5,null,62.5,62.5,null,62.5,62,null,62,62,null,62.5,63,null,63,63],"text":["y: 1.13774274","y: 1.13774274",null,"y: 1.13774274","y: 1.13774274",null,"y: 0.96901610","y: 0.96901610",null,"y: 0.96901610","y: 0.96901610",null,"y: 0.60630248","y: 0.60630248",null,"y: 0.60630248","y: 0.60630248",null,"y: 0.33065388","y: 0.33065388",null,"y: 0.33065388","y: 0.33065388",null,"y: 0.33065388","y: 0.33065388",null,"y: 0.33065388","y: 0.33065388",null,"y: 0.60630248","y: 0.60630248",null,"y: 0.60630248","y: 0.60630248",null,"y: 0.31427617","y: 0.31427617",null,"y: 0.31427617","y: 0.31427617",null,"y: 0.31427617","y: 0.31427617",null,"y: 0.31427617","y: 0.31427617",null,"y: 0.96901610","y: 0.96901610",null,"y: 0.96901610","y: 0.96901610",null,"y: 0.52732148","y: 0.52732148",null,"y: 0.52732148","y: 0.52732148",null,"y: 0.33411003","y: 0.33411003",null,"y: 0.33411003","y: 0.33411003",null,"y: 0.33411003","y: 0.33411003",null,"y: 0.33411003","y: 0.33411003",null,"y: 0.13234019","y: 0.13234019",null,"y: 0.13234019","y: 0.13234019",null,"y: 0.13234019","y: 0.13234019",null,"y: 0.13234019","y: 0.13234019",null,"y: 0.52732148","y: 0.52732148",null,"y: 0.52732148","y: 0.52732148",null,"y: 0.38956860","y: 0.38956860",null,"y: 0.38956860","y: 0.38956860",null,"y: 0.31922418","y: 0.31922418",null,"y: 0.31922418","y: 0.31922418",null,"y: 0.14884979","y: 0.14884979",null,"y: 0.14884979","y: 0.14884979",null,"y: 0.14884979","y: 0.14884979",null,"y: 0.14884979","y: 0.14884979",null,"y: 0.31922418","y: 0.31922418",null,"y: 0.31922418","y: 0.31922418",null,"y: 0.14315856","y: 0.14315856",null,"y: 0.14315856","y: 0.14315856",null,"y: 0.14315856","y: 0.14315856",null,"y: 0.14315856","y: 0.14315856",null,"y: 0.38956860","y: 0.38956860",null,"y: 0.38956860","y: 0.38956860",null,"y: 0.18786086","y: 0.18786086",null,"y: 0.18786086","y: 0.18786086",null,"y: 0.18786086","y: 0.18786086",null,"y: 0.18786086","y: 0.18786086"],"type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(125,176,221,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.1377427442871084,1.1377427442871084,null,1.1377427442871084,0.89798773380396057,null,0.89798773380396057,0.89798773380396057,null,0.89798773380396057,0.78819984021797174,null,0.78819984021797174,0.78819984021797174,null,0.78819984021797174,0.56344085449358972,null,0.56344085449358972,0.56344085449358972,null,0.56344085449358972,0.48572663476381084,null,0.48572663476381084,0.48572663476381084,null,0.48572663476381084,0.23913199095856211,null,0.23913199095856211,0.23913199095856211,null,0.23913199095856211,0.18418171229191999,null,0.18418171229191999,0.18418171229191999,null,0.18418171229191999,0,null,0.18418171229191999,0.18418171229191999,null,0.18418171229191999,0,null,0.23913199095856211,0.23913199095856211,null,0.23913199095856211,0.093930430119570682,null,0.093930430119570682,0.093930430119570682,null,0.093930430119570682,0,null,0.093930430119570682,0.093930430119570682,null,0.093930430119570682,0.066170093380643752,null,0.066170093380643752,0.066170093380643752,null,0.066170093380643752,0,null,0.066170093380643752,0.066170093380643752,null,0.066170093380643752,0,null,0.48572663476381084,0.48572663476381084,null,0.48572663476381084,0.30108471575706475,null,0.30108471575706475,0.30108471575706475,null,0.30108471575706475,0.14938515409195602,null,0.14938515409195602,0.14938515409195602,null,0.14938515409195602,0,null,0.14938515409195602,0.14938515409195602,null,0.14938515409195602,0,null,0.30108471575706475,0.30108471575706475,null,0.30108471575706475,0.20189878739368669,null,0.20189878739368669,0.20189878739368669,null,0.20189878739368669,0,null,0.20189878739368669,0.20189878739368669,null,0.20189878739368669,0,null,0.56344085449358972,0.56344085449358972,null,0.56344085449358972,0,null,0.78819984021797174,0.78819984021797174,null,0.78819984021797174,0.75080630757578126,null,0.75080630757578126,0.75080630757578126,null,0.75080630757578126,0.5129591166866212,null,0.5129591166866212,0.5129591166866212,null,0.5129591166866212,0.31811565293169819,null,0.31811565293169819,0.31811565293169819,null,0.31811565293169819,0.13522305607503274,null,0.13522305607503274,0.13522305607503274,null,0.13522305607503274,0,null,0.13522305607503274,0.13522305607503274,null,0.13522305607503274,0,null,0.31811565293169819,0.31811565293169819,null,0.31811565293169819,0,null,0.5129591166866212,0.5129591166866212,null,0.5129591166866212,0.39436403863707981,null,0.39436403863707981,0.39436403863707981,null,0.39436403863707981,0.24211793850409949,null,0.24211793850409949,0.24211793850409949,null,0.24211793850409949,0,null,0.24211793850409949,0.24211793850409949,null,0.24211793850409949,0,null,0.39436403863707981,0.39436403863707981,null,0.39436403863707981,0.33462839540933348,null,0.33462839540933348,0.33462839540933348,null,0.33462839540933348,0.067365766419596768,null,0.067365766419596768,0.067365766419596768,null,0.067365766419596768,0,null,0.067365766419596768,0.067365766419596768,null,0.067365766419596768,0,null,0.33462839540933348,0.33462839540933348,null,0.33462839540933348,0.12668831808002276,null,0.12668831808002276,0.12668831808002276,null,0.12668831808002276,0.078916221355973468,null,0.078916221355973468,0.078916221355973468,null,0.078916221355973468,0,null,0.078916221355973468,0.078916221355973468,null,0.078916221355973468,0,null,0.12668831808002276,0.12668831808002276,null,0.12668831808002276,0,null,0.75080630757578126,0.75080630757578126,null,0.75080630757578126,0.37602736368399947,null,0.37602736368399947,0.37602736368399947,null,0.37602736368399947,0.11466553631330777,null,0.11466553631330777,0.11466553631330777,null,0.11466553631330777,0,null,0.11466553631330777,0.11466553631330777,null,0.11466553631330777,0,null,0.37602736368399947,0.37602736368399947,null,0.37602736368399947,0.16408013256093529,null,0.16408013256093529,0.16408013256093529,null,0.16408013256093529,0,null,0.16408013256093529,0.16408013256093529,null,0.16408013256093529,0,null,0.89798773380396057,0.89798773380396057,null,0.89798773380396057,0.59130729734181375,null,0.59130729734181375,0.59130729734181375,null,0.59130729734181375,0.27823073697178002,null,0.27823073697178002,0.27823073697178002,null,0.27823073697178002,0,null,0.27823073697178002,0.27823073697178002,null,0.27823073697178002,0,null,0.59130729734181375,0.59130729734181375,null,0.59130729734181375,0.38384926121756052,null,0.38384926121756052,0.38384926121756052,null,0.38384926121756052,0.25313832120508051,null,0.25313832120508051,0.25313832120508051,null,0.25313832120508051,0.1709863722288737,null,0.1709863722288737,0.1709863722288737,null,0.1709863722288737,0,null,0.1709863722288737,0.1709863722288737,null,0.1709863722288737,0,null,0.25313832120508051,0.25313832120508051,null,0.25313832120508051,0,null,0.38384926121756052,0.38384926121756052,null,0.38384926121756052,0.24995568698625295,null,0.24995568698625295,0.24995568698625295,null,0.24995568698625295,0,null,0.24995568698625295,0.24995568698625295,null,0.24995568698625295,0.21851833182272373,null,0.21851833182272373,0.21851833182272373,null,0.21851833182272373,0,null,0.21851833182272373,0.21851833182272373,null,0.21851833182272373,0],"y":[46.830078125,38.22265625,null,38.22265625,38.22265625,null,38.22265625,30.9453125,null,30.9453125,30.9453125,null,30.9453125,25.53125,null,25.53125,25.53125,null,25.53125,23.0625,null,23.0625,23.0625,null,23.0625,20.625,null,20.625,20.625,null,20.625,19.5,null,19.5,19.5,null,19.5,19,null,19,19,null,19.5,20,null,20,20,null,20.625,21.75,null,21.75,21.75,null,21.75,21,null,21,21,null,21.75,22.5,null,22.5,22.5,null,22.5,22,null,22,22,null,22.5,23,null,23,23,null,23.0625,25.5,null,25.5,25.5,null,25.5,24.5,null,24.5,24.5,null,24.5,24,null,24,24,null,24.5,25,null,25,25,null,25.5,26.5,null,26.5,26.5,null,26.5,26,null,26,26,null,26.5,27,null,27,27,null,25.53125,28,null,28,28,null,30.9453125,36.359375,null,36.359375,36.359375,null,36.359375,32.21875,null,32.21875,32.21875,null,32.21875,30.25,null,30.25,30.25,null,30.25,29.5,null,29.5,29.5,null,29.5,29,null,29,29,null,29.5,30,null,30,30,null,30.25,31,null,31,31,null,32.21875,34.1875,null,34.1875,34.1875,null,34.1875,32.5,null,32.5,32.5,null,32.5,32,null,32,32,null,32.5,33,null,33,33,null,34.1875,35.875,null,35.875,35.875,null,35.875,34.5,null,34.5,34.5,null,34.5,34,null,34,34,null,34.5,35,null,35,35,null,35.875,37.25,null,37.25,37.25,null,37.25,36.5,null,36.5,36.5,null,36.5,36,null,36,36,null,36.5,37,null,37,37,null,37.25,38,null,38,38,null,36.359375,40.5,null,40.5,40.5,null,40.5,39.5,null,39.5,39.5,null,39.5,39,null,39,39,null,39.5,40,null,40,40,null,40.5,41.5,null,41.5,41.5,null,41.5,41,null,41,41,null,41.5,42,null,42,42,null,38.22265625,45.5,null,45.5,45.5,null,45.5,43.5,null,43.5,43.5,null,43.5,43,null,43,43,null,43.5,44,null,44,44,null,45.5,47.5,null,47.5,47.5,null,47.5,46.25,null,46.25,46.25,null,46.25,45.5,null,45.5,45.5,null,45.5,45,null,45,45,null,45.5,46,null,46,46,null,46.25,47,null,47,47,null,47.5,48.75,null,48.75,48.75,null,48.75,48,null,48,48,null,48.75,49.5,null,49.5,49.5,null,49.5,49,null,49,49,null,49.5,50,null,50,50],"text":["y: 1.13774274","y: 1.13774274",null,"y: 1.13774274","y: 1.13774274",null,"y: 0.89798773","y: 0.89798773",null,"y: 0.89798773","y: 0.89798773",null,"y: 0.78819984","y: 0.78819984",null,"y: 0.78819984","y: 0.78819984",null,"y: 0.56344085","y: 0.56344085",null,"y: 0.56344085","y: 0.56344085",null,"y: 0.48572663","y: 0.48572663",null,"y: 0.48572663","y: 0.48572663",null,"y: 0.23913199","y: 0.23913199",null,"y: 0.23913199","y: 0.23913199",null,"y: 0.18418171","y: 0.18418171",null,"y: 0.18418171","y: 0.18418171",null,"y: 0.18418171","y: 0.18418171",null,"y: 0.18418171","y: 0.18418171",null,"y: 0.23913199","y: 0.23913199",null,"y: 0.23913199","y: 0.23913199",null,"y: 0.09393043","y: 0.09393043",null,"y: 0.09393043","y: 0.09393043",null,"y: 0.09393043","y: 0.09393043",null,"y: 0.09393043","y: 0.09393043",null,"y: 0.06617009","y: 0.06617009",null,"y: 0.06617009","y: 0.06617009",null,"y: 0.06617009","y: 0.06617009",null,"y: 0.06617009","y: 0.06617009",null,"y: 0.48572663","y: 0.48572663",null,"y: 0.48572663","y: 0.48572663",null,"y: 0.30108472","y: 0.30108472",null,"y: 0.30108472","y: 0.30108472",null,"y: 0.14938515","y: 0.14938515",null,"y: 0.14938515","y: 0.14938515",null,"y: 0.14938515","y: 0.14938515",null,"y: 0.14938515","y: 0.14938515",null,"y: 0.30108472","y: 0.30108472",null,"y: 0.30108472","y: 0.30108472",null,"y: 0.20189879","y: 0.20189879",null,"y: 0.20189879","y: 0.20189879",null,"y: 0.20189879","y: 0.20189879",null,"y: 0.20189879","y: 0.20189879",null,"y: 0.56344085","y: 0.56344085",null,"y: 0.56344085","y: 0.56344085",null,"y: 0.78819984","y: 0.78819984",null,"y: 0.78819984","y: 0.78819984",null,"y: 0.75080631","y: 0.75080631",null,"y: 0.75080631","y: 0.75080631",null,"y: 0.51295912","y: 0.51295912",null,"y: 0.51295912","y: 0.51295912",null,"y: 0.31811565","y: 0.31811565",null,"y: 0.31811565","y: 0.31811565",null,"y: 0.13522306","y: 0.13522306",null,"y: 0.13522306","y: 0.13522306",null,"y: 0.13522306","y: 0.13522306",null,"y: 0.13522306","y: 0.13522306",null,"y: 0.31811565","y: 0.31811565",null,"y: 0.31811565","y: 0.31811565",null,"y: 0.51295912","y: 0.51295912",null,"y: 0.51295912","y: 0.51295912",null,"y: 0.39436404","y: 0.39436404",null,"y: 0.39436404","y: 0.39436404",null,"y: 0.24211794","y: 0.24211794",null,"y: 0.24211794","y: 0.24211794",null,"y: 0.24211794","y: 0.24211794",null,"y: 0.24211794","y: 0.24211794",null,"y: 0.39436404","y: 0.39436404",null,"y: 0.39436404","y: 0.39436404",null,"y: 0.33462840","y: 0.33462840",null,"y: 0.33462840","y: 0.33462840",null,"y: 0.06736577","y: 0.06736577",null,"y: 0.06736577","y: 0.06736577",null,"y: 0.06736577","y: 0.06736577",null,"y: 0.06736577","y: 0.06736577",null,"y: 0.33462840","y: 0.33462840",null,"y: 0.33462840","y: 0.33462840",null,"y: 0.12668832","y: 0.12668832",null,"y: 0.12668832","y: 0.12668832",null,"y: 0.07891622","y: 0.07891622",null,"y: 0.07891622","y: 0.07891622",null,"y: 0.07891622","y: 0.07891622",null,"y: 0.07891622","y: 0.07891622",null,"y: 0.12668832","y: 0.12668832",null,"y: 0.12668832","y: 0.12668832",null,"y: 0.75080631","y: 0.75080631",null,"y: 0.75080631","y: 0.75080631",null,"y: 0.37602736","y: 0.37602736",null,"y: 0.37602736","y: 0.37602736",null,"y: 0.11466554","y: 0.11466554",null,"y: 0.11466554","y: 0.11466554",null,"y: 0.11466554","y: 0.11466554",null,"y: 0.11466554","y: 0.11466554",null,"y: 0.37602736","y: 0.37602736",null,"y: 0.37602736","y: 0.37602736",null,"y: 0.16408013","y: 0.16408013",null,"y: 0.16408013","y: 0.16408013",null,"y: 0.16408013","y: 0.16408013",null,"y: 0.16408013","y: 0.16408013",null,"y: 0.89798773","y: 0.89798773",null,"y: 0.89798773","y: 0.89798773",null,"y: 0.59130730","y: 0.59130730",null,"y: 0.59130730","y: 0.59130730",null,"y: 0.27823074","y: 0.27823074",null,"y: 0.27823074","y: 0.27823074",null,"y: 0.27823074","y: 0.27823074",null,"y: 0.27823074","y: 0.27823074",null,"y: 0.59130730","y: 0.59130730",null,"y: 0.59130730","y: 0.59130730",null,"y: 0.38384926","y: 0.38384926",null,"y: 0.38384926","y: 0.38384926",null,"y: 0.25313832","y: 0.25313832",null,"y: 0.25313832","y: 0.25313832",null,"y: 0.17098637","y: 0.17098637",null,"y: 0.17098637","y: 0.17098637",null,"y: 0.17098637","y: 0.17098637",null,"y: 0.17098637","y: 0.17098637",null,"y: 0.25313832","y: 0.25313832",null,"y: 0.25313832","y: 0.25313832",null,"y: 0.38384926","y: 0.38384926",null,"y: 0.38384926","y: 0.38384926",null,"y: 0.24995569","y: 0.24995569",null,"y: 0.24995569","y: 0.24995569",null,"y: 0.24995569","y: 0.24995569",null,"y: 0.24995569","y: 0.24995569",null,"y: 0.21851833","y: 0.21851833",null,"y: 0.21851833","y: 0.21851833",null,"y: 0.21851833","y: 0.21851833",null,"y: 0.21851833","y: 0.21851833"],"type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(134,184,117,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.5097084258060014,1.5097084258060014,null,1.5097084258060014,1.0279663942985842,null,1.0279663942985842,1.0279663942985842,null,1.0279663942985842,0.83006336523871405,null,0.83006336523871405,0.83006336523871405,null,0.83006336523871405,0.54759430820101995,null,0.54759430820101995,0.54759430820101995,null,0.54759430820101995,0,null,0.54759430820101995,0.54759430820101995,null,0.54759430820101995,0.28937516374117966,null,0.28937516374117966,0.28937516374117966,null,0.28937516374117966,0,null,0.28937516374117966,0.28937516374117966,null,0.28937516374117966,0,null,0.83006336523871405,0.83006336523871405,null,0.83006336523871405,0.57858584711431638,null,0.57858584711431638,0.57858584711431638,null,0.57858584711431638,0.33411003384069676,null,0.33411003384069676,0.33411003384069676,null,0.33411003384069676,0,null,0.33411003384069676,0.33411003384069676,null,0.33411003384069676,0.22684479652443681,null,0.22684479652443681,0.22684479652443681,null,0.22684479652443681,0.12610712174440278,null,0.12610712174440278,0.12610712174440278,null,0.12610712174440278,0,null,0.12610712174440278,0.12610712174440278,null,0.12610712174440278,0,null,0.22684479652443681,0.22684479652443681,null,0.22684479652443681,0,null,0.57858584711431638,0.57858584711431638,null,0.57858584711431638,0.44681252934909554,null,0.44681252934909554,0.44681252934909554,null,0.44681252934909554,0,null,0.44681252934909554,0.44681252934909554,null,0.44681252934909554,0.29914714718319724,null,0.29914714718319724,0.29914714718319724,null,0.29914714718319724,0.14867848956639407,null,0.14867848956639407,0.14867848956639407,null,0.14867848956639407,0,null,0.14867848956639407,0.14867848956639407,null,0.14867848956639407,0,null,0.29914714718319724,0.29914714718319724,null,0.29914714718319724,0,null,1.0279663942985842,1.0279663942985842,null,1.0279663942985842,0.70588933561248612,null,0.70588933561248612,0.70588933561248612,null,0.70588933561248612,0.37139187153495962,null,0.37139187153495962,0.37139187153495962,null,0.37139187153495962,0.26998969732153055,null,0.26998969732153055,0.26998969732153055,null,0.26998969732153055,0,null,0.26998969732153055,0.26998969732153055,null,0.26998969732153055,0.15783244271194699,null,0.15783244271194699,0.15783244271194699,null,0.15783244271194699,0,null,0.15783244271194699,0.15783244271194699,null,0.15783244271194699,0,null,0.37139187153495962,0.37139187153495962,null,0.37139187153495962,0,null,0.70588933561248612,0.70588933561248612,null,0.70588933561248612,0.48180802596553524,null,0.48180802596553524,0.48180802596553524,null,0.48180802596553524,0,null,0.48180802596553524,0.48180802596553524,null,0.48180802596553524,0.26672433055893258,null,0.26672433055893258,0.26672433055893258,null,0.26672433055893258,0,null,0.26672433055893258,0.26672433055893258,null,0.26672433055893258,0],"y":[28.3525390625,9.875,null,9.875,9.875,null,9.875,4.4375,null,4.4375,4.4375,null,4.4375,1.75,null,1.75,1.75,null,1.75,1,null,1,1,null,1.75,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,4.4375,7.125,null,7.125,7.125,null,7.125,5.125,null,5.125,5.125,null,5.125,4,null,4,4,null,5.125,6.25,null,6.25,6.25,null,6.25,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.25,7,null,7,7,null,7.125,9.125,null,9.125,9.125,null,9.125,8,null,8,8,null,9.125,10.25,null,10.25,10.25,null,10.25,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10,null,10.25,11,null,11,11,null,9.875,15.3125,null,15.3125,15.3125,null,15.3125,13.875,null,13.875,13.875,null,13.875,12.75,null,12.75,12.75,null,12.75,12,null,12,12,null,12.75,13.5,null,13.5,13.5,null,13.5,13,null,13,13,null,13.5,14,null,14,14,null,13.875,15,null,15,15,null,15.3125,16.75,null,16.75,16.75,null,16.75,16,null,16,16,null,16.75,17.5,null,17.5,17.5,null,17.5,17,null,17,17,null,17.5,18,null,18,18],"text":["y: 1.50970843","y: 1.50970843",null,"y: 1.50970843","y: 1.50970843",null,"y: 1.02796639","y: 1.02796639",null,"y: 1.02796639","y: 1.02796639",null,"y: 0.83006337","y: 0.83006337",null,"y: 0.83006337","y: 0.83006337",null,"y: 0.54759431","y: 0.54759431",null,"y: 0.54759431","y: 0.54759431",null,"y: 0.54759431","y: 0.54759431",null,"y: 0.54759431","y: 0.54759431",null,"y: 0.28937516","y: 0.28937516",null,"y: 0.28937516","y: 0.28937516",null,"y: 0.28937516","y: 0.28937516",null,"y: 0.28937516","y: 0.28937516",null,"y: 0.83006337","y: 0.83006337",null,"y: 0.83006337","y: 0.83006337",null,"y: 0.57858585","y: 0.57858585",null,"y: 0.57858585","y: 0.57858585",null,"y: 0.33411003","y: 0.33411003",null,"y: 0.33411003","y: 0.33411003",null,"y: 0.33411003","y: 0.33411003",null,"y: 0.33411003","y: 0.33411003",null,"y: 0.22684480","y: 0.22684480",null,"y: 0.22684480","y: 0.22684480",null,"y: 0.12610712","y: 0.12610712",null,"y: 0.12610712","y: 0.12610712",null,"y: 0.12610712","y: 0.12610712",null,"y: 0.12610712","y: 0.12610712",null,"y: 0.22684480","y: 0.22684480",null,"y: 0.22684480","y: 0.22684480",null,"y: 0.57858585","y: 0.57858585",null,"y: 0.57858585","y: 0.57858585",null,"y: 0.44681253","y: 0.44681253",null,"y: 0.44681253","y: 0.44681253",null,"y: 0.44681253","y: 0.44681253",null,"y: 0.44681253","y: 0.44681253",null,"y: 0.29914715","y: 0.29914715",null,"y: 0.29914715","y: 0.29914715",null,"y: 0.14867849","y: 0.14867849",null,"y: 0.14867849","y: 0.14867849",null,"y: 0.14867849","y: 0.14867849",null,"y: 0.14867849","y: 0.14867849",null,"y: 0.29914715","y: 0.29914715",null,"y: 0.29914715","y: 0.29914715",null,"y: 1.02796639","y: 1.02796639",null,"y: 1.02796639","y: 1.02796639",null,"y: 0.70588934","y: 0.70588934",null,"y: 0.70588934","y: 0.70588934",null,"y: 0.37139187","y: 0.37139187",null,"y: 0.37139187","y: 0.37139187",null,"y: 0.26998970","y: 0.26998970",null,"y: 0.26998970","y: 0.26998970",null,"y: 0.26998970","y: 0.26998970",null,"y: 0.26998970","y: 0.26998970",null,"y: 0.15783244","y: 0.15783244",null,"y: 0.15783244","y: 0.15783244",null,"y: 0.15783244","y: 0.15783244",null,"y: 0.15783244","y: 0.15783244",null,"y: 0.37139187","y: 0.37139187",null,"y: 0.37139187","y: 0.37139187",null,"y: 0.70588934","y: 0.70588934",null,"y: 0.70588934","y: 0.70588934",null,"y: 0.48180803","y: 0.48180803",null,"y: 0.48180803","y: 0.48180803",null,"y: 0.48180803","y: 0.48180803",null,"y: 0.48180803","y: 0.48180803",null,"y: 0.26672433","y: 0.26672433",null,"y: 0.26672433","y: 0.26672433",null,"y: 0.26672433","y: 0.26672433",null,"y: 0.26672433","y: 0.26672433"],"type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(228,149,165,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.5097084258060014,1.5097084258060014,null,1.5097084258060014,1.1377427442871084],"y":[28.3525390625,46.830078125,null,46.830078125,46.830078125],"text":"y: 1.50970843","type":"scatter","mode":"lines","line":{"width":2.2677165354330708,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.5097084258060014,1.0279663942985842,0.83006336523871405,0.54759430820101995,0,0.28937516374117966,0,0,0.57858584711431638,0.33411003384069676,0,0.22684479652443681,0.12610712174440278,0,0,0,0.44681252934909554,0,0.29914714718319724,0.14867848956639407,0,0,0,0.70588933561248612,0.37139187153495962,0.26998969732153055,0,0.15783244271194699,0,0,0,0.48180802596553524,0,0.26672433055893258,0,0,1.1377427442871084,0.89798773380396057,0.78819984021797174,0.56344085449358972,0.48572663476381084,0.23913199095856211,0.18418171229191999,0,0,0.093930430119570682,0,0.066170093380643752,0,0,0.30108471575706475,0.14938515409195602,0,0,0.20189878739368669,0,0,0,0.75080630757578126,0.5129591166866212,0.31811565293169819,0.13522305607503274,0,0,0,0.39436403863707981,0.24211793850409949,0,0,0.33462839540933348,0.067365766419596768,0,0,0.12668831808002276,0.078916221355973468,0,0,0,0.37602736368399947,0.11466553631330777,0,0,0.16408013256093529,0,0,0.59130729734181375,0.27823073697178002,0,0,0.38384926121756052,0.25313832120508051,0.1709863722288737,0,0,0,0.24995568698625295,0,0.21851833182272373,0,0,0.96901609618933204,0.60630248397627962,0.33065387899893084,0,0,0.31427617363549509,0,0,0.52732148399590562,0.33411003384069671,0,0.13234018676128761,0,0,0.3895686037815545,0.31922417727301361,0.14884978681805652,0,0,0.14315856377593858,0,0,0.18786086023914148,0,0],"y":[28.3525390625,9.875,4.4375,1.75,1,2.5,2,3,7.125,5.125,4,6.25,5.5,5,6,7,9.125,8,10.25,9.5,9,10,11,15.3125,13.875,12.75,12,13.5,13,14,15,16.75,16,17.5,17,18,46.830078125,38.22265625,30.9453125,25.53125,23.0625,20.625,19.5,19,20,21.75,21,22.5,22,23,25.5,24.5,24,25,26.5,26,27,28,36.359375,32.21875,30.25,29.5,29,30,31,34.1875,32.5,32,33,35.875,34.5,34,35,37.25,36.5,36,37,38,40.5,39.5,39,40,41.5,41,42,45.5,43.5,43,44,47.5,46.25,45.5,45,46,47,48.75,48,49.5,49,50,55.4375,52.5,51.5,51,52,53.5,53,54,58.375,55.75,55,56.5,56,57,61,59.5,58.5,58,59,60.5,60,61,62.5,62,63],"text":["y: 1.50970843","y: 1.02796639","y: 0.83006337","y: 0.54759431","y: 0.00000000","y: 0.28937516","y: 0.00000000","y: 0.00000000","y: 0.57858585","y: 0.33411003","y: 0.00000000","y: 0.22684480","y: 0.12610712","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.44681253","y: 0.00000000","y: 0.29914715","y: 0.14867849","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.70588934","y: 0.37139187","y: 0.26998970","y: 0.00000000","y: 0.15783244","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.48180803","y: 0.00000000","y: 0.26672433","y: 0.00000000","y: 0.00000000","y: 1.13774274","y: 0.89798773","y: 0.78819984","y: 0.56344085","y: 0.48572663","y: 0.23913199","y: 0.18418171","y: 0.00000000","y: 0.00000000","y: 0.09393043","y: 0.00000000","y: 0.06617009","y: 0.00000000","y: 0.00000000","y: 0.30108472","y: 0.14938515","y: 0.00000000","y: 0.00000000","y: 0.20189879","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.75080631","y: 0.51295912","y: 0.31811565","y: 0.13522306","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.39436404","y: 0.24211794","y: 0.00000000","y: 0.00000000","y: 0.33462840","y: 0.06736577","y: 0.00000000","y: 0.00000000","y: 0.12668832","y: 0.07891622","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.37602736","y: 0.11466554","y: 0.00000000","y: 0.00000000","y: 0.16408013","y: 0.00000000","y: 0.00000000","y: 0.59130730","y: 0.27823074","y: 0.00000000","y: 0.00000000","y: 0.38384926","y: 0.25313832","y: 0.17098637","y: 0.00000000","y: 0.00000000","y: 0.00000000","y: 0.24995569","y: 0.00000000","y: 0.21851833","y: 0.00000000","y: 0.00000000","y: 0.96901610","y: 0.60630248","y: 0.33065388","y: 0.00000000","y: 0.00000000","y: 0.31427617","y: 0.00000000","y: 0.00000000","y: 0.52732148","y: 0.33411003","y: 0.00000000","y: 0.13234019","y: 0.00000000","y: 0.00000000","y: 0.38956860","y: 0.31922418","y: 0.14884979","y: 0.00000000","y: 0.00000000","y: 0.14315856","y: 0.00000000","y: 0.00000000","y: 0.18786086","y: 0.00000000","y: 0.00000000"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"transparent","opacity":1,"size":null,"symbol":null,"line":{"width":1.8897637795275593,"color":"transparent"}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"xaxis":{"domain":[0,0.80000000000000004],"automargin":true,"type":"linear","autorange":false,"range":[0.5,4.5],"tickmode":"array","ticktext":["security_ind","theft_ind","police_ind","gangster_ind"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["security_ind","theft_ind","police_ind","gangster_ind"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":6.6417600664175991},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"PCI Indicators","hoverformat":".2f"},"xaxis2":{"domain":[0.80000000000000004,1],"automargin":true,"type":"linear","autorange":false,"range":[0,1.5097084258060014],"tickmode":"array","ticktext":["0.0","0.5","1.0","1.5"],"tickvals":[0,0.49999999999999994,0.99999999999999989,1.5],"categoryorder":"array","categoryarray":["0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":null,"family":null,"size":0}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,63.5],"tickmode":"array","ticktext":["Long An","An Giang","Quang Binh","Quang Nam","Lao Cai","Ba Ria - Vung Tau","Dong Thap","Tra Vinh","Kien Giang","Dong Nai","Binh Thuan","Binh Duong","Binh Phuoc","Nghe An","Gia Lai","Ninh Binh","Kon Tum","Binh Dinh","Dien Bien","Phu Tho","Cao Bang","Lang Son","Son La","Tay Ninh","Dak Nong","Tien Giang","Soc Trang","Bac Lieu","Can Tho city","Ha Giang","Ca Mau","Ha Tinh","Lam Dong","Quang Ninh","Bac Giang","Ha Noi","Hai Duong","Yen Bai","Da Nang city","Quang Ngai","Hai Phong city","Tuyen Quang","Thai Binh","Thua Thien Hue","Nam Dinh","Bac Kan","Hung Yen","Vinh Phuc","Thanh Hoa","Thai Nguyen","Bac Ninh","Ninh Thuan","Ha Nam","Ho Chi Minh city","Quang Tri","Hoa Binh","Khanh Hoa","Lai Chau","Ben Tre","Vinh Long","Dak Lak","Hau Giang","Phu Yen"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63],"categoryorder":"array","categoryarray":["Long An","An Giang","Quang Binh","Quang Nam","Lao Cai","Ba Ria - Vung Tau","Dong Thap","Tra Vinh","Kien Giang","Dong Nai","Binh Thuan","Binh Duong","Binh Phuoc","Nghe An","Gia Lai","Ninh Binh","Kon Tum","Binh Dinh","Dien Bien","Phu Tho","Cao Bang","Lang Son","Son La","Tay Ninh","Dak Nong","Tien Giang","Soc Trang","Bac Lieu","Can Tho city","Ha Giang","Ca Mau","Ha Tinh","Lam Dong","Quang Ninh","Bac Giang","Ha Noi","Hai Duong","Yen Bai","Da Nang city","Quang Ngai","Hai Phong city","Tuyen Quang","Thai Binh","Thua Thien Hue","Nam Dinh","Bac Kan","Hung Yen","Vinh Phuc","Thanh Hoa","Thai Nguyen","Bac Ninh","Ninh Thuan","Ha Nam","Ho Chi Minh city","Quang Tri","Hoa Binh","Khanh Hoa","Lai Chau","Ben Tre","Vinh Long","Dak Lak","Hau Giang","Phu Yen"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":5.3134080531340802},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176002,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"Province of Vietnam","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.80000000000000004,"y0":0,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.80000000000000004,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":60,"r":null,"b":38.256537982565376,"l":200},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Geographic Segmentation of Vietnam Provinces by PCI indicators"},"attrs":{"4cd824cf7334":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"},"4cd87e2d7c6b":{"xend":{},"yend":{},"colour":{},"linetype":{},"size":{},"x":{},"y":{},"type":"scatter"},"4cd838f177cd":{"colour":{},"shape":{},"size":{},"x":{},"y":{}}},"source":"A","config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Mapping cluster formed</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">cutree</span>(hclust_ward, <span class="at">k=</span><span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>vietnam_cluster <span class="ot">&lt;-</span> <span class="fu">cbind</span>(vietnam, <span class="fu">as.matrix</span>(groups)) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"CLUSTER"</span> <span class="ot">=</span> <span class="st">"as.matrix.groups."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(vietnam_cluster, <span class="st">"CLUSTER"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>